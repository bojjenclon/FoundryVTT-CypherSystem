/*! cyphersystem v1.0.0 | (c) 2020 Cornell Daly | MIT License | https://github.com/bojjenclon/ */

!(function(){return function e(t,r,a){function n(l,s){if(!r[l]){if(!t[l]){var o="function"==typeof require&&require;if(!s&&o)return o(l,!0);if(i)return i(l,!0);var u=new Error("Cannot find module '"+l+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[l]={exports:{}};t[l][0].call(c.exports,(function(e){return n(t[l][1][e]||e)}),c,c.exports,e,t,r,a)}return r[l].exports}for(var i="function"==typeof require&&require,l=0;l<a.length;l++)n(a[l]);return n}})()({1:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.CypherSystemActorSheet=void 0;var n=a(e("@babel/runtime/helpers/slicedToArray")),i=a(e("@babel/runtime/regenerator")),l=a(e("@babel/runtime/helpers/asyncToGenerator")),s=a(e("@babel/runtime/helpers/classCallCheck")),o=a(e("@babel/runtime/helpers/createClass")),u=a(e("@babel/runtime/helpers/inherits")),c=a(e("@babel/runtime/helpers/possibleConstructorReturn")),f=a(e("@babel/runtime/helpers/get")),p=a(e("@babel/runtime/helpers/getPrototypeOf")),d=e("../config.js"),h=e("../rolls.js"),m=e("../item/item.js"),y=e("../utils.js"),v=a(e("../enums/enum-pool.js"));function b(e){var t=(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}})();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,c.default)(this,r)}}var g=(function(e){(0,u.default)(r,e);var t=b(r);function r(){var e;(0,s.default)(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).skillsPoolFilter=-1,e.skillsTrainingFilter=-1,e.selectedSkill=null,e.abilityPoolFilter=-1,e.selectedAbility=null,e.inventoryTypeFilter=-1,e.selectedInvItem=null,e}return(0,o.default)(r,[{key:"template",get:function(){return"systems/cyphersystemClean/templates/actor/pc-sheet.html"}}],[{key:"defaultOptions",get:function(){return mergeObject((0,f.default)((0,p.default)(r),"defaultOptions",this),{classes:["cyphersystem","sheet","actor"],width:672,height:600,tabs:[{navSelector:".sheet-tabs",contentSelector:".sheet-body",initial:"description"},{navSelector:".stats-tabs",contentSelector:".stats-body",initial:"advancement"}],scrollY:[".tab.inventory .inventory-list",".tab.inventory .inventory-info"]})}}]),(0,o.default)(r,[{key:"_generateItemData",value:function(e,t,r){var a=e.data.items;a[r]||(a[r]=a.filter((function(e){return e.type===t})))}},{key:"_filterItemData",value:function(e,t,r,a){var n=e.data.items;n[t]=n[t].filter((function(e){return(0,y.deepProp)(e,r)===a}))}},{key:"_skillData",value:(function(){var e=(0,l.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._generateItemData(t,"skill","skills"),t.skillsPoolFilter=this.skillsPoolFilter,t.skillsTrainingFilter=this.skillsTrainingFilter,t.skillsPoolFilter>-1&&this._filterItemData(t,"skills","data.pool",parseInt(t.skillsPoolFilter,10)),t.skillsTrainingFilter>-1&&this._filterItemData(t,"skills","data.training",parseInt(t.skillsTrainingFilter,10)),t.selectedSkill=this.selectedSkill,t.skillInfo="",!t.selectedSkill){e.next=11;break}return e.next=10,t.selectedSkill.getInfo();case 10:t.skillInfo=e.sent;case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}})()},{key:"_abilityData",value:(function(){var e=(0,l.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._generateItemData(t,"ability","abilities"),t.abilityPoolFilter=this.abilityPoolFilter,t.abilityPoolFilter>-1&&this._filterItemData(t,"abilities","data.cost.pool",parseInt(t.abilityPoolFilter,10)),t.selectedAbility=this.selectedAbility,t.abilityInfo="",!t.selectedAbility){e.next=9;break}return e.next=8,t.selectedAbility.getInfo();case 8:t.abilityInfo=e.sent;case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}})()},{key:"_inventoryData",value:(function(){var e=(0,l.default)(i.default.mark((function e(t){var r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.inventoryTypes=d.CSR.inventoryTypes,(r=t.data.items).inventory||(r.inventory=r.filter((function(e){return d.CSR.inventoryTypes.includes(e.type)})),r.inventory.sort((function(e,t){return e.type>t.type?1:-1}))),t.inventoryTypeFilter=this.inventoryTypeFilter,t.inventoryTypeFilter>-1&&this._filterItemData(t,"inventory","type",d.CSR.inventoryTypes[parseInt(t.inventoryTypeFilter,10)]),t.selectedInvItem=this.selectedInvItem,t.invItemInfo="",!t.selectedInvItem){e.next=11;break}return e.next=10,t.selectedInvItem.getInfo();case 10:t.invItemInfo=e.sent;case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}})()},{key:"getData",value:(function(){var e=(0,l.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=(0,f.default)((0,p.default)(r.prototype),"getData",this).call(this)).isGM=game.user.isGM,t.ranges=d.CSR.ranges,t.stats=d.CSR.stats,t.weaponTypes=d.CSR.weaponTypes,t.weights=d.CSR.weightClasses,t.advances=Object.entries(t.actor.data.advances).map((function(e){var t=(0,n.default)(e,2),r=t[0],a=t[1];return{name:r,label:d.CSR.advances[r],isChecked:a}})),t.damageTrackData=d.CSR.damageTrack,t.damageTrackDescription=d.CSR.damageTrack[t.data.damageTrack].description,t.recoveriesData=Object.entries(t.actor.data.recoveries).map((function(e){var t=(0,n.default)(e,2),r=t[0],a=t[1];return{key:r,label:d.CSR.recoveries[r],checked:a}})),t.trainingLevels=d.CSR.trainingLevels,t.data.items=t.actor.items||{},e.next=14,this._skillData(t);case 14:return e.next=16,this._abilityData(t);case 16:return e.next=18,this._inventoryData(t);case 18:return e.abrupt("return",t);case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()},{key:"_createItem",value:function(e){var t={name:"New ".concat(e.capitalize()),type:e,data:new m.CypherSystemItem({})};this.actor.createOwnedItem(t,{renderSheet:!0})}},{key:"_rollPoolDialog",value:function(e){var t=this.actor,r=t.data.data,a=v.default[e];h.CypherRolls.Roll({event:event,parts:["1d20"],data:{pool:e,maxEffort:r.effort},speaker:ChatMessage.getSpeaker({actor:t}),flavor:"".concat(t.name," used ").concat(a),title:"Use Pool",actor:t})}},{key:"_deleteItemDialog",value:function(e,t){var r=this;new Dialog({title:game.i18n.localize("CSR.dialog.deleteTitle"),content:"<p>".concat(game.i18n.localize("CSR.dialog.deleteContent"),"</p><hr />"),buttons:{confirm:{icon:'<i class="fas fa-check"></i>',label:game.i18n.localize("CSR.dialog.deleteButton"),callback:function(){r.actor.deleteOwnedItem(e),t&&t(!0)}},cancel:{icon:'<i class="fas fa-times"></i>',label:game.i18n.localize("CSR.dialog.cancelButton"),callback:function(){t&&t(!1)}}},default:"cancel"}).render(!0)}},{key:"_statsTabListeners",value:function(e){var t=this;e.find(".roll-pool").click((function(e){e.preventDefault();for(var r=e.target;!r.dataset.pool;)r=r.parentElement;var a=r.dataset.pool;t._rollPoolDialog(parseInt(a,10))})),e.find('select[name="data.damageTrack"]').select2({theme:"numenera",width:"130px",minimumResultsForSearch:1/0})}},{key:"_skillsTabListeners",value:function(e){var t=this;e.find(".add-skill").click((function(e){e.preventDefault(),t._createItem("skill")})),e.find('select[name="skillsPoolFilter"]').select2({theme:"numenera",width:"130px",minimumResultsForSearch:1/0}).on("change",(function(e){t.skillsPoolFilter=e.target.value,t.selectedSkill=null})),e.find('select[name="skillsTrainingFilter"]').select2({theme:"numenera",width:"130px",minimumResultsForSearch:1/0}).on("change",(function(e){t.skillsTrainingFilter=e.target.value})),e.find("a.skill").on("click",(function(e){e.preventDefault(),t._onSubmit(e);for(var r=e.target;!r.dataset.id;)r=r.parentElement;var a=r.dataset.id,n=t.actor.getOwnedItem(a);t.selectedSkill=n}));var r=this.selectedSkill;r&&(e.find(".skill-info .actions .roll").click((function(e){e.preventDefault(),r.roll()})),e.find(".skill-info .actions .edit").click((function(e){e.preventDefault(),t.selectedSkill.sheet.render(!0)})),e.find(".skill-info .actions .delete").click((function(e){e.preventDefault(),t._deleteItemDialog(t.selectedSkill._id,(function(e){e&&(t.selectedSkill=null)}))})))}},{key:"_abilityTabListeners",value:function(e){var t=this;e.find(".add-ability").click((function(e){e.preventDefault(),t._createItem("ability")})),e.find('select[name="abilityPoolFilter"]').select2({theme:"numenera",width:"130px",minimumResultsForSearch:1/0}).on("change",(function(e){t.abilityPoolFilter=e.target.value,t.selectedAbility=null})),e.find("a.ability").on("click",(function(e){e.preventDefault(),t._onSubmit(e);for(var r=e.target;!r.dataset.id;)r=r.parentElement;var a=r.dataset.id,n=t.actor.getOwnedItem(a);t.selectedAbility=n}));var r=this.selectedAbility;r&&(e.find(".ability-info .actions .roll").click((function(e){e.preventDefault(),r.roll()})),e.find(".ability-info .actions .edit").click((function(e){e.preventDefault(),t.selectedAbility.sheet.render(!0)})),e.find(".ability-info .actions .delete").click((function(e){e.preventDefault(),t._deleteItemDialog(t.selectedAbility._id,(function(e){e&&(t.selectedAbility=null)}))})))}},{key:"_inventoryTabListeners",value:function(e){var t=this,r=e.find(".contextmenu"),a=e.find(".add-inventory"),n=[];d.CSR.inventoryTypes.forEach((function(e){n.push({name:game.i18n.localize("CSR.inventory.".concat(e)),icon:"",callback:function(){t._createItem(e)}})}));var i=new ContextMenu(e,".active",n);a.click((function(e){e.preventDefault(),r.offset(a.offset()),i.render(r.find(".container"))})),e.on("mousedown",(function(e){e.target!==a[0]&&i.close()})),e.find('select[name="inventoryTypeFilter"]').select2({theme:"numenera",width:"130px",minimumResultsForSearch:1/0}).on("change",(function(e){t.inventoryTypeFilter=e.target.value,t.selectedInvItem=null})),e.find("a.inv-item").on("click",(function(e){e.preventDefault(),t._onSubmit(e);for(var r=e.target;!r.dataset.id;)r=r.parentElement;var a=r.dataset.id,n=t.actor.getOwnedItem(a);t.selectedInvItem=n})),this.selectedInvItem&&(e.find(".inventory-info .actions .edit").click((function(e){e.preventDefault(),t.selectedInvItem.sheet.render(!0)})),e.find(".inventory-info .actions .delete").click((function(e){e.preventDefault(),t._deleteItemDialog(t.selectedInvItem._id,(function(e){e&&(t.selectedInvItem=null)}))})))}},{key:"activateListeners",value:function(e){(0,f.default)((0,p.default)(r.prototype),"activateListeners",this).call(this,e),this.options.editable&&(e.find('.item[data-tab="stats"]').click((function(){var t=e.find(".stats-tabs .item.active").first(),r=e.find('.stats-body .tab[data-tab="'.concat(t.data("tab"),'"]'));setTimeout((function(){r.addClass("active")}),0)})),this._statsTabListeners(e),this._skillsTabListeners(e),this._abilityTabListeners(e),this._inventoryTabListeners(e))}}]),r})(ActorSheet);r.CypherSystemActorSheet=g},{"../config.js":3,"../enums/enum-pool.js":6,"../item/item.js":13,"../rolls.js":14,"../utils.js":16,"@babel/runtime/helpers/asyncToGenerator":20,"@babel/runtime/helpers/classCallCheck":21,"@babel/runtime/helpers/createClass":22,"@babel/runtime/helpers/get":23,"@babel/runtime/helpers/getPrototypeOf":24,"@babel/runtime/helpers/inherits":25,"@babel/runtime/helpers/interopRequireDefault":26,"@babel/runtime/helpers/possibleConstructorReturn":29,"@babel/runtime/helpers/slicedToArray":31,"@babel/runtime/regenerator":36}],2:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.CypherSystemActor=void 0;var n=a(e("@babel/runtime/regenerator")),i=a(e("@babel/runtime/helpers/asyncToGenerator")),l=a(e("@babel/runtime/helpers/classCallCheck")),s=a(e("@babel/runtime/helpers/createClass")),o=a(e("@babel/runtime/helpers/get")),u=a(e("@babel/runtime/helpers/inherits")),c=a(e("@babel/runtime/helpers/possibleConstructorReturn")),f=a(e("@babel/runtime/helpers/getPrototypeOf")),p=a(e("../enums/enum-pool.js")),d=e("../config.js");function h(e){var t=(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}})();return function(){var r,a=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,c.default)(this,r)}}var m=(function(e){(0,u.default)(r,e);var t=h(r);function r(){return(0,l.default)(this,r),t.apply(this,arguments)}return(0,s.default)(r,[{key:"_preparePCData",value:function(e){e.data}},{key:"prepareData",value:function(){(0,o.default)((0,f.default)(r.prototype),"prepareData",this).call(this);var e=this.data;e.data,e.flags;"pc"===e.type&&this._preparePCData(e)}},{key:"getSkillLevel",value:function(e){return e.data.data.training-1}},{key:"getEffortCostFromStat",value:function(e,t){var r={cost:0,effortLevel:0,warning:null};if(0===t)return r;var a=this.data.data,n=p.default[e],i=a.stats[n.toLowerCase()],l=(i.value+i.edge-1)/2,s=Math.min(t,a.effort,l),o=1+2*s-i.edge,u=null;return t>l&&(u="Not enough points in your ".concat(n," pool for that level of Effort")),r.cost=o,r.effortLevel=s,r.warning=u,r}},{key:"canSpendFromPool",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=this.data.data,n=p.default[e].toLowerCase(),i=a.stats[n],l=i.value;return(r?t-i.edge:t)<=l}},{key:"spendFromPool",value:function(e,t){if(!this.canSpendFromPool(e,t))return!1;var r=this.data.data,a=p.default[e],n=r.stats[a.toLowerCase()],i={};return i["data.stats.".concat(a.toLowerCase(),".value")]=Math.max(0,n.value-t),this.update(i),!0}},{key:"createEmbeddedEntity",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t,a,i,l,s,u,c=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=c.length,i=new Array(a),l=0;l<a;l++)i[l]=c[l];if(i[0],!(s=i[1]).data||!d.CSR.hasLevelDie.includes(s.type)){e.next=17;break}if((u=s.data).level||!u.levelDie){e.next=16;break}return e.prev=5,u.level=new Roll(u.levelDie).roll().total,e.next=9,this.update({_id:this._id,"data.level":u.level});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),u.level=u.level||null;case 14:e.next=17;break;case 16:u.level=u.level||null;case 17:return e.abrupt("return",(t=(0,o.default)((0,f.default)(r.prototype),"createEmbeddedEntity",this)).call.apply(t,[this].concat(i)));case 18:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(){return e.apply(this,arguments)}})()}]),r})(Actor);r.CypherSystemActor=m},{"../config.js":3,"../enums/enum-pool.js":6,"@babel/runtime/helpers/asyncToGenerator":20,"@babel/runtime/helpers/classCallCheck":21,"@babel/runtime/helpers/createClass":22,"@babel/runtime/helpers/get":23,"@babel/runtime/helpers/getPrototypeOf":24,"@babel/runtime/helpers/inherits":25,"@babel/runtime/helpers/interopRequireDefault":26,"@babel/runtime/helpers/possibleConstructorReturn":29,"@babel/runtime/regenerator":36}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CSR=void 0;var a={};r.CSR=a,a.itemTypes=["skills","abilities","cyphers","artifacts","oddities","weapons","armor","gear"],a.inventoryTypes=["weapon","armor","gear","cypher","artifact","oddity"],a.weightClasses=["Light","Medium","Heavy"],a.weaponTypes=["Bashing","Bladed","Ranged"],a.stats=["Might","Speed","Intellect"],a.trainingLevels=["Inability","Untrained","Trained","Specialized"],a.damageTrack=[{label:"Hale",description:"Normal state for a character."},{label:"Impaired",description:"In a wounded or injured state. Applying Effort costs 1 extra point per effort level applied."},{label:"Debilitated",description:"In a critically injured state. The character can do no other action than to crawl an immediate distance; if their Speed pool is 0, they cannot move at all."},{label:"Dead",description:"The character is dead."}],a.recoveries={action:"1 Action",tenMins:"10 mins",oneHour:"1 hour",tenHours:"10 hours"},a.advances={stats:"+4 to stat pools",edge:"+1 to Edge",effort:"+1 to Effort",skills:"Train/specialize skill",other:"Other"},a.ranges=["Immediate","Short","Long","Very Long"],a.optionalRanges=["N/A"].concat(a.ranges),a.abilityTypes=["Action","Enabler"],a.supportsMacros=["skill","ability"],a.hasLevelDie=["cypher","artifact"]},{}],4:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault"),n=a(e("@babel/runtime/regenerator")),i=a(e("@babel/runtime/helpers/asyncToGenerator")),l=e("./actor/actor.js"),s=e("./actor/actor-sheet.js"),o=e("./item/item.js"),u=e("./item/item-sheet.js"),c=e("./handlebars-helpers.js"),f=e("./template.js");Hooks.once("init",(0,i.default)(n.default.mark((function e(){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:game.cyphersystemClean={CypherSystemActor:l.CypherSystemActor,CypherSystemItem:o.CypherSystemItem},CONFIG.Combat.initiative={formula:"1d20",decimals:2},CONFIG.Actor.entityClass=l.CypherSystemActor,CONFIG.Item.entityClass=o.CypherSystemItem,Actors.unregisterSheet("core",ActorSheet),Actors.registerSheet("cyphersystemClean",s.CypherSystemActorSheet,{types:["pc"],makeDefault:!0}),Actors.registerSheet("cyphersystemClean",s.CypherSystemActorSheet,{types:["npc"],makeDefault:!0}),Items.unregisterSheet("core",ItemSheet),Items.registerSheet("cyphersystemClean",u.CypherSystemItemSheet,{makeDefault:!0}),(0,c.registerHandlebarHelpers)(),(0,f.preloadHandlebarsTemplates)();case 11:case"end":return e.stop()}}),e)}))))},{"./actor/actor-sheet.js":1,"./actor/actor.js":2,"./handlebars-helpers.js":11,"./item/item-sheet.js":12,"./item/item.js":13,"./template.js":15,"@babel/runtime/helpers/asyncToGenerator":20,"@babel/runtime/helpers/interopRequireDefault":26,"@babel/runtime/regenerator":36}],5:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.RollDialog=void 0;var n=a(e("@babel/runtime/helpers/classCallCheck")),i=a(e("@babel/runtime/helpers/createClass")),l=a(e("@babel/runtime/helpers/get")),s=a(e("@babel/runtime/helpers/inherits")),o=a(e("@babel/runtime/helpers/possibleConstructorReturn")),u=a(e("@babel/runtime/helpers/getPrototypeOf"));function c(e){var t=(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}})();return function(){var r,a=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,o.default)(this,r)}}var f=(function(e){(0,s.default)(r,e);var t=c(r);function r(e,a){return(0,n.default)(this,r),t.call(this,e,a)}return(0,i.default)(r,[{key:"activateListeners",value:function(e){(0,l.default)((0,u.default)(r.prototype),"activateListeners",this).call(this,e),e.find('select[name="rollMode"]').select2({theme:"numenera",width:"135px",minimumResultsForSearch:1/0})}}]),r})(Dialog);r.RollDialog=f},{"@babel/runtime/helpers/classCallCheck":21,"@babel/runtime/helpers/createClass":22,"@babel/runtime/helpers/get":23,"@babel/runtime/helpers/getPrototypeOf":24,"@babel/runtime/helpers/inherits":25,"@babel/runtime/helpers/interopRequireDefault":26,"@babel/runtime/helpers/possibleConstructorReturn":29}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=["Might","Speed","Intellect"];r.default=a},{}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=["Immediate","Short","Long","Very Long"];r.default=a},{}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=["Inability","Untrained","Trained","Specialized"];r.default=a},{}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=["Bladed","Bashing","Ranged"];r.default=a},{}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=["Light","Medium","Heavy"];r.default=a},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.registerHandlebarHelpers=void 0;r.registerHandlebarHelpers=function(){Handlebars.registerHelper("toLowerCase",(function(e){return e.toLowerCase()})),Handlebars.registerHelper("toUpperCase",(function(e){return e.toUpperCase()})),Handlebars.registerHelper("eq",(function(e,t){return e===t})),Handlebars.registerHelper("neq",(function(e,t){return e!==t})),Handlebars.registerHelper("or",(function(e,t){return e||t})),Handlebars.registerHelper("ternary",(function(e,t,r){return e?t:r})),Handlebars.registerHelper("concat",(function(e,t){return"".concat(e).concat(t)})),Handlebars.registerHelper("strOrSpace",(function(e){return"string"==typeof e?e&&e.length?e:"&nbsp;":e})),Handlebars.registerHelper("trainingIcon",(function(e){switch(e){case 0:return'<span title="'.concat(game.i18n.localize("CSR.training.inability"),'">[I]</span>');case 1:return'<span title="'.concat(game.i18n.localize("CSR.training.untrained"),'">[U]</span>');case 2:return'<span title="'.concat(game.i18n.localize("CSR.training.trained"),'">[T]</span>');case 3:return'<span title="'.concat(game.i18n.localize("CSR.training.specialized"),'">[S]</span>')}return""})),Handlebars.registerHelper("poolIcon",(function(e){switch(e){case 0:return'<span title="'.concat(game.i18n.localize("CSR.pool.might"),'">[M]</span>');case 1:return'<span title="'.concat(game.i18n.localize("CSR.pool.speed"),'">[S]</span>');case 2:return'<span title="'.concat(game.i18n.localize("CSR.pool.intellect"),'">[I]</span>')}return""})),Handlebars.registerHelper("typeIcon",(function(e){switch(e){case"armor":return'<span title="'.concat(game.i18n.localize("CSR.inventory.armor"),'">[a]</span>');case"weapon":return'<span title="'.concat(game.i18n.localize("CSR.inventory.weapon"),'">[w]</span>');case"gear":return'<span title="'.concat(game.i18n.localize("CSR.inventory.gear"),'">[g]</span>');case"cypher":return'<span title="'.concat(game.i18n.localize("CSR.inventory.cypher"),'">[C]</span>');case"artifact":return'<span title="'.concat(game.i18n.localize("CSR.inventory.armor"),'">[A]</span>');case"oddity":return'<span title="'.concat(game.i18n.localize("CSR.inventory.armor"),'">[O]</span>')}return""}))}},{}],12:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.CypherSystemItemSheet=void 0;var n=a(e("@babel/runtime/helpers/classCallCheck")),i=a(e("@babel/runtime/helpers/createClass")),l=a(e("@babel/runtime/helpers/get")),s=a(e("@babel/runtime/helpers/inherits")),o=a(e("@babel/runtime/helpers/possibleConstructorReturn")),u=a(e("@babel/runtime/helpers/getPrototypeOf")),c=e("../config.js");function f(e){var t=(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}})();return function(){var r,a=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,o.default)(this,r)}}var p=(function(e){(0,s.default)(r,e);var t=f(r);function r(){return(0,n.default)(this,r),t.apply(this,arguments)}return(0,i.default)(r,[{key:"_skillData",value:function(e){e.stats=c.CSR.stats,e.trainingLevels=c.CSR.trainingLevels}},{key:"_abilityData",value:function(e){e.data.ranges=c.CSR.optionalRanges,e.data.stats=c.CSR.stats}},{key:"_armorData",value:function(e){e.weightClasses=c.CSR.weightClasses}},{key:"_weaponData",value:function(e){e.ranges=c.CSR.ranges,e.weaponTypes=c.CSR.weaponTypes,e.weightClasses=c.CSR.weightClasses}},{key:"_gearData",value:function(e){}},{key:"_cypherData",value:function(e){e.isGM=game.user.isGM}},{key:"_artifactData",value:function(e){e.isGM=game.user.isGM}},{key:"_oddityData",value:function(e){e.isGM=game.user.isGM}},{key:"getData",value:function(){var e=(0,l.default)((0,u.default)(r.prototype),"getData",this).call(this);switch(this.item.data.type){case"skill":this._skillData(e);break;case"ability":this._abilityData(e);break;case"armor":this._armorData(e);break;case"weapon":this._weaponData(e);break;case"gear":this._gearData(e);break;case"cypher":this._cypherData(e);break;case"artifact":this._artifactData(e);break;case"oddity":this._oddityData(e)}return e}},{key:"setPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.default)((0,u.default)(r.prototype),"setPosition",this).call(this,e),a=this.element.find(".sheet-body"),n=t.height-192;return a.css("height",n),t}},{key:"_skillListeners",value:function(e){e.closest(".window-app.sheet.item").addClass("skill-window"),e.find('select[name="data.stat"]').select2({theme:"numenera",width:"110px",minimumResultsForSearch:1/0}),e.find('select[name="data.training"]').select2({theme:"numenera",width:"110px",minimumResultsForSearch:1/0})}},{key:"_abilityListeners",value:function(e){var t=this;e.closest(".window-app.sheet.item").addClass("ability-window"),e.find('select[name="data.isEnabler"]').select2({theme:"numenera",width:"220px",minimumResultsForSearch:1/0}),e.find('select[name="data.cost.pool"]').select2({theme:"numenera",width:"85px",minimumResultsForSearch:1/0}),e.find('select[name="data.range"]').select2({theme:"numenera",width:"120px",minimumResultsForSearch:1/0}),e.find("#cb-identified").on("change",(function(e){e.preventDefault(),e.stopPropagation(),t.item.update({"data.identified":e.target.checked})}))}},{key:"_armorListeners",value:function(e){e.closest(".window-app.sheet.item").addClass("armor-window"),e.find('select[name="data.weight"]').select2({theme:"numenera",width:"100px",minimumResultsForSearch:1/0})}},{key:"_weaponListeners",value:function(e){e.closest(".window-app.sheet.item").addClass("weapon-window"),e.find('select[name="data.weight"]').select2({theme:"numenera",width:"110px",minimumResultsForSearch:1/0}),e.find('select[name="data.weaponType"]').select2({theme:"numenera",width:"110px",minimumResultsForSearch:1/0}),e.find('select[name="data.range"]').select2({theme:"numenera",width:"120px",minimumResultsForSearch:1/0})}},{key:"_gearListeners",value:function(e){e.closest(".window-app.sheet.item").addClass("gear-window")}},{key:"_cypherListeners",value:function(e){e.closest(".window-app.sheet.item").addClass("cypher-window")}},{key:"_artifactListeners",value:function(e){e.closest(".window-app.sheet.item").addClass("artifact-window")}},{key:"_oddityListeners",value:function(e){e.closest(".window-app.sheet.item").addClass("oddity-window")}},{key:"activateListeners",value:function(e){if((0,l.default)((0,u.default)(r.prototype),"activateListeners",this).call(this,e),this.options.editable)switch(this.item.data.type){case"skill":this._skillListeners(e);break;case"ability":this._abilityListeners(e);break;case"armor":this._armorListeners(e);break;case"weapon":this._weaponListeners(e);break;case"gear":this._gearListeners(e);break;case"cypher":this._cypherListeners(e);break;case"artifact":this._artifactListeners(e);break;case"oddity":this._oddityListeners(e)}}},{key:"template",get:function(){return"".concat("systems/cyphersystemClean/templates/item","/").concat(this.item.data.type,"-sheet.html")}}],[{key:"defaultOptions",get:function(){return mergeObject((0,l.default)((0,u.default)(r),"defaultOptions",this),{classes:["cyphersystem","sheet","item"],width:300,height:200})}}]),r})(ItemSheet);r.CypherSystemItemSheet=p},{"../config.js":3,"@babel/runtime/helpers/classCallCheck":21,"@babel/runtime/helpers/createClass":22,"@babel/runtime/helpers/get":23,"@babel/runtime/helpers/getPrototypeOf":24,"@babel/runtime/helpers/inherits":25,"@babel/runtime/helpers/interopRequireDefault":26,"@babel/runtime/helpers/possibleConstructorReturn":29}],13:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.CypherSystemItem=void 0;var n=a(e("@babel/runtime/regenerator")),i=a(e("@babel/runtime/helpers/asyncToGenerator")),l=a(e("@babel/runtime/helpers/classCallCheck")),s=a(e("@babel/runtime/helpers/createClass")),o=a(e("@babel/runtime/helpers/get")),u=a(e("@babel/runtime/helpers/inherits")),c=a(e("@babel/runtime/helpers/possibleConstructorReturn")),f=a(e("@babel/runtime/helpers/getPrototypeOf")),p=e("../rolls.js"),d=e("../utils.js"),h=a(e("../enums/enum-pool.js")),m=a(e("../enums/enum-training.js")),y=a(e("../enums/enum-weight.js")),v=a(e("../enums/enum-range.js")),b=a(e("../enums/enum-weapon-category.js"));function g(e){var t=(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}})();return function(){var r,a=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,c.default)(this,r)}}var k=(function(e){(0,u.default)(r,e);var t=g(r);function r(){return(0,l.default)(this,r),t.apply(this,arguments)}return(0,s.default)(r,[{key:"_prepareSkillData",value:function(){var e=this.data,t=e.data;t.name=(0,d.valOrDefault)(e.name,game.i18n.localize("CSR.new.skill")),t.pool=(0,d.valOrDefault)(t.pool,0),t.training=(0,d.valOrDefault)(t.training,1),t.notes=(0,d.valOrDefault)(t.notes,"")}},{key:"_prepareAbilityData",value:function(){var e=this.data,t=e.data;t.name=(0,d.valOrDefault)(e.name,game.i18n.localize("CSR.new.ability")),t.sourceType=(0,d.valOrDefault)(t.sourceType,""),t.sourceValue=(0,d.valOrDefault)(t.sourceValue,""),t.isEnabler=(0,d.valOrDefault)(t.isEnabler,!0),t.cost=(0,d.valOrDefault)(t.cost,{value:0,pool:0}),t.range=(0,d.valOrDefault)(t.range,0),t.notes=(0,d.valOrDefault)(t.notes,"")}},{key:"_prepareArmorData",value:function(){var e=this.data,t=e.data;t.name=(0,d.valOrDefault)(e.name,game.i18n.localize("CSR.new.armor")),t.armor=(0,d.valOrDefault)(t.armor,1),t.additionalSpeedEffortCost=(0,d.valOrDefault)(t.additionalSpeedEffortCost,1),t.price=(0,d.valOrDefault)(t.price,0),t.weight=(0,d.valOrDefault)(t.weight,0),t.quantity=(0,d.valOrDefault)(t.quantity,1),t.equipped=(0,d.valOrDefault)(t.equipped,!1),t.notes=(0,d.valOrDefault)(t.notes,"")}},{key:"_prepareWeaponData",value:function(){var e=this.data,t=e.data;t.name=(0,d.valOrDefault)(e.name,game.i18n.localize("CSR.new.weapon")),t.damage=(0,d.valOrDefault)(t.damage,1),t.category=(0,d.valOrDefault)(t.category,0),t.range=(0,d.valOrDefault)(t.range,0),t.price=(0,d.valOrDefault)(t.price,0),t.weight=(0,d.valOrDefault)(t.weight,0),t.quantity=(0,d.valOrDefault)(t.quantity,1),t.equipped=(0,d.valOrDefault)(t.equipped,!1),t.notes=(0,d.valOrDefault)(t.notes,"")}},{key:"_prepareGearData",value:function(){var e=this.data,t=e.data;t.name=(0,d.valOrDefault)(e.name,game.i18n.localize("CSR.new.gear")),t.price=(0,d.valOrDefault)(t.price,0),t.quantity=(0,d.valOrDefault)(t.quantity,1),t.notes=(0,d.valOrDefault)(t.notes,"")}},{key:"_prepareCypherData",value:function(){var e=this.data,t=e.data;t.name=(0,d.valOrDefault)(e.name,game.i18n.localize("CSR.new.cypher")),t.identified=(0,d.valOrDefault)(t.identified,!1),t.level=(0,d.valOrDefault)(t.level,null),t.levelDie=(0,d.valOrDefault)(t.levelDie,""),t.form=(0,d.valOrDefault)(t.form,""),t.effect=(0,d.valOrDefault)(t.effect,""),t.notes=(0,d.valOrDefault)(t.notes,"")}},{key:"_prepareArtifactData",value:function(){var e=this.data,t=e.data;t.name=(0,d.valOrDefault)(e.name,game.i18n.localize("CSR.new.artifact")),t.identified=(0,d.valOrDefault)(t.identified,!1),t.level=(0,d.valOrDefault)(t.level,null),t.levelDie=(0,d.valOrDefault)(t.levelDie,""),t.form=(0,d.valOrDefault)(t.form,""),t.effect=(0,d.valOrDefault)(t.effect,""),t.depletion=(0,d.valOrDefault)(t.depletion,{isDepleting:!0,die:"d6",threshold:1}),t.notes=(0,d.valOrDefault)(t.notes,"")}},{key:"_prepareOddityData",value:function(){var e=this.data,t=e.data;t.name=(0,d.valOrDefault)(e.name,game.i18n.localize("CSR.new.oddity")),t.notes=(0,d.valOrDefault)(t.notes,"")}},{key:"prepareData",value:function(){switch((0,o.default)((0,f.default)(r.prototype),"prepareData",this).call(this),this.type){case"skill":this._prepareSkillData();break;case"ability":this._prepareAbilityData();break;case"armor":this._prepareArmorData();break;case"weapon":this._prepareWeaponData();break;case"gear":this._prepareGearData();break;case"cypher":this._prepareCypherData();break;case"artifact":this._prepareArtifactData();break;case"oddity":this._prepareOddityData()}}},{key:"_skillRoll",value:function(){var e=this.actor,t=e.data.data,r=this.name,a=this.data.data.pool,n=e.getSkillLevel(this),i=["1d20"];if(0!==n){var l=n<0?"-":"+";i.push("".concat(l," ").concat(3*Math.abs(n)))}p.CypherRolls.Roll({event:event,parts:i,data:{pool:a,abilityCost:0,maxEffort:t.effort,assets:n},speaker:ChatMessage.getSpeaker({actor:e}),flavor:"".concat(e.name," used ").concat(r),title:"Use Skill",actor:e})}},{key:"_abilityRoll",value:function(){var e=this.actor,t=e.data.data,r=this.name,a=this.data.data,n=a.isEnabler,i=a.cost;if(n)ChatMessage.create([{speaker:ChatMessage.getSpeaker({actor:e}),flavor:"Invalid Ability",content:"This ability is an Enabler and cannot be rolled for."}]);else{var l=i.pool;if(e.canSpendFromPool(l,parseInt(i.amount,10)))p.CypherRolls.Roll({event:event,parts:["1d20"],data:{pool:l,abilityCost:i.amount,maxEffort:t.effort},speaker:ChatMessage.getSpeaker({actor:e}),flavor:"".concat(e.name," used ").concat(r),title:"Use Ability",actor:e});else{var s=h.default[l];ChatMessage.create([{speaker:ChatMessage.getSpeaker({actor:e}),flavor:"Ability Failed",content:"Not enough points in ".concat(s," pool.")}])}}}},{key:"roll",value:function(){switch(this.type){case"skill":this._skillRoll();break;case"ability":this._abilityRoll()}}},{key:"_skillInfo",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t,r,a,i,l;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.data,r=m.default[t.data.training],a=h.default[t.data.pool],i={name:t.name,training:r.toLowerCase(),pool:a.toLowerCase(),notes:t.data.notes},e.next=6,renderTemplate("systems/cyphersystemClean/templates/actor/partials/info/skill-info.html",i);case 6:return l=e.sent,e.abrupt("return",l);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()},{key:"_abilityInfo",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t,r,a,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.data,r=h.default[t.data.cost.pool],a={name:t.name,pool:r.toLowerCase(),isEnabler:t.data.isEnabler,notes:t.data.notes},e.next=5,renderTemplate("systems/cyphersystemClean/templates/actor/partials/info/ability-info.html",a);case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()},{key:"_armorInfo",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t,r,a,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.data,r=y.default[t.data.weight],a={name:this.name,type:this.type,equipped:t.equipped,quantity:t.data.quantity,weight:r.toLowerCase(),armor:t.data.armor,additionalSpeedEffortCost:t.data.additionalSpeedEffortCost,price:t.data.price,notes:t.data.notes},e.next=5,renderTemplate("systems/cyphersystemClean/templates/actor/partials/info/armor-info.html",a);case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()},{key:"_weaponInfo",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t,r,a,i,l,s;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.data,r=y.default[t.data.weight],a=v.default[t.data.range],i=b.default[t.data.category],l={name:this.name,type:this.type,equipped:t.equipped,quantity:t.data.quantity,weight:r.toLowerCase(),range:a.toLowerCase(),category:i.toLowerCase(),damage:t.data.damage,price:t.data.price,notes:t.data.notes},e.next=7,renderTemplate("systems/cyphersystemClean/templates/actor/partials/info/weapon-info.html",l);case 7:return s=e.sent,e.abrupt("return",s);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()},{key:"_gearInfo",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t,r,a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.data,r={name:t.name,type:this.type,quantity:t.data.quantity,price:t.data.price,notes:t.data.notes},e.next=4,renderTemplate("systems/cyphersystemClean/templates/actor/partials/info/gear-info.html",r);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()},{key:"_cypherInfo",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t,r,a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.data,r={name:t.name,type:this.type,isGM:game.user.isGM,identified:t.data.identified,level:t.data.level,form:t.data.form,effect:t.data.effect},e.next=4,renderTemplate("systems/cyphersystemClean/templates/actor/partials/info/cypher-info.html",r);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()},{key:"_artifactInfo",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t,r,a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.data,r={name:t.name,type:this.type,isGM:game.user.isGM,identified:t.data.identified,level:t.data.level,form:t.data.form,isDepleting:t.data.depletion.isDepleting,depletionThreshold:t.data.depletion.threshold,depletionDie:t.data.depletion.die,effect:t.data.effect},e.next=4,renderTemplate("systems/cyphersystemClean/templates/actor/partials/info/artifact-info.html",r);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()},{key:"_oddityInfo",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t,r,a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.data,r={name:t.name,type:this.type,notes:t.data.notes},e.next=4,renderTemplate("systems/cyphersystemClean/templates/actor/partials/info/oddity-info.html",r);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()},{key:"getInfo",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t="",e.t0=this.type,e.next="skill"===e.t0?4:"ability"===e.t0?8:"armor"===e.t0?12:"weapon"===e.t0?16:"gear"===e.t0?20:"cypher"===e.t0?24:"artifact"===e.t0?28:"oddity"===e.t0?32:36;break;case 4:return e.next=6,this._skillInfo();case 6:return t=e.sent,e.abrupt("break",36);case 8:return e.next=10,this._abilityInfo();case 10:return t=e.sent,e.abrupt("break",36);case 12:return e.next=14,this._armorInfo();case 14:return t=e.sent,e.abrupt("break",36);case 16:return e.next=18,this._weaponInfo();case 18:return t=e.sent,e.abrupt("break",36);case 20:return e.next=22,this._gearInfo();case 22:return t=e.sent,e.abrupt("break",36);case 24:return e.next=26,this._cypherInfo();case 26:return t=e.sent,e.abrupt("break",36);case 28:return e.next=30,this._artifactInfo();case 30:return t=e.sent,e.abrupt("break",36);case 32:return e.next=34,this._oddityInfo();case 34:return t=e.sent,e.abrupt("break",36);case 36:return e.abrupt("return",t);case 37:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()}]),r})(Item);r.CypherSystemItem=k},{"../enums/enum-pool.js":6,"../enums/enum-range.js":7,"../enums/enum-training.js":8,"../enums/enum-weapon-category.js":9,"../enums/enum-weight.js":10,"../rolls.js":14,"../utils.js":16,"@babel/runtime/helpers/asyncToGenerator":20,"@babel/runtime/helpers/classCallCheck":21,"@babel/runtime/helpers/createClass":22,"@babel/runtime/helpers/get":23,"@babel/runtime/helpers/getPrototypeOf":24,"@babel/runtime/helpers/inherits":25,"@babel/runtime/helpers/interopRequireDefault":26,"@babel/runtime/helpers/possibleConstructorReturn":29,"@babel/runtime/regenerator":36}],14:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.CypherRolls=void 0;var n=a(e("@babel/runtime/regenerator")),i=a(e("@babel/runtime/helpers/asyncToGenerator")),l=a(e("@babel/runtime/helpers/classCallCheck")),s=a(e("@babel/runtime/helpers/createClass")),o=e("./dialog/roll-dialog.js"),u=a(e("./enums/enum-pool.js")),c=(function(){function e(){(0,l.default)(this,e)}return(0,s.default)(e,null,[{key:"Roll",value:(function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t})((0,i.default)(n.default.mark((function e(){var t,r,a,i,l,s,c,f,p,d,h,m,y,v,b,g,k,w,C,D,S,_,R,x=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=x.length>0&&void 0!==x[0]?x[0]:{},r=t.parts,a=void 0===r?[]:r,i=t.data,l=void 0===i?{}:i,s=t.actor,c=void 0===s?null:s,f=t.event,void 0===f?null:f,p=t.speaker,d=void 0===p?null:p,h=t.flavor,m=void 0===h?null:h,y=t.title,v=void 0===y?null:y,b=t.item,void 0!==b&&b,g=game.settings.get("core","rollMode"),k=!1,w=a.filter((function(e){return""!=e&&e})),C=1,l.maxEffort&&(C=parseInt(l.maxEffort,10)||1),D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null!==e&&(l.effort=parseInt(e.effort.value,10)),l.effort&&(w.push("+".concat(3*l.effort)),m+=" with ".concat(l.effort," Effort"));var t=new Roll(w.join(""),l).roll();return g=e?e.rollMode.value:g,k=!0,t},"systems/cyphersystemClean/templates/dialog/roll-dialog.html",S={formula:w.join(" "),maxEffort:C,data:l,rollMode:g,rollModes:CONFIG.Dice.rollModes},e.next=11,renderTemplate("systems/cyphersystemClean/templates/dialog/roll-dialog.html",S);case 11:return _=e.sent,e.abrupt("return",new Promise(function(e){new o.RollDialog({title:v,content:_,buttons:{ok:{label:"OK",icon:'<i class="fas fa-check"></i>',callback:function(e){R=D(e[0].children[0]);var t=l.pool,r=parseInt(l.effort||0,10),a=c.getEffortCostFromStat(t,r),n=parseInt(l.abilityCost||0,10)+parseInt(a.cost,10);if(c.canSpendFromPool(t,n)&&!a.warning)R.toMessage({speaker:d,flavor:m},{rollMode:g}),c.spendFromPool(t,n);else{var i=u.default[t];ChatMessage.create([{speaker:d,flavor:"Roll Failed",content:"Not enough points in ".concat(i," pool.")}])}}},cancel:{icon:'<i class="fas fa-times"></i>',label:"Cancel"}},default:"ok",close:function(){e(!!k&&R)}}).render(!0)}));case 13:case"end":return e.stop()}}),e)}))))}]),e})();r.CypherRolls=c},{"./dialog/roll-dialog.js":5,"./enums/enum-pool.js":6,"@babel/runtime/helpers/asyncToGenerator":20,"@babel/runtime/helpers/classCallCheck":21,"@babel/runtime/helpers/createClass":22,"@babel/runtime/helpers/interopRequireDefault":26,"@babel/runtime/regenerator":36}],15:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.preloadHandlebarsTemplates=void 0;var n=a(e("@babel/runtime/regenerator")),i=a(e("@babel/runtime/helpers/asyncToGenerator")),l=(function(){var e=(0,i.default)(n.default.mark((function e(){var t;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["systems/cyphersystemClean/templates/actor/actor-sheet.html","systems/cyphersystemClean/templates/actor/pc-sheet.html","systems/cyphersystemClean/templates/actor/partials/pools.html","systems/cyphersystemClean/templates/actor/partials/advancement.html","systems/cyphersystemClean/templates/actor/partials/damage-track.html","systems/cyphersystemClean/templates/actor/partials/recovery.html","systems/cyphersystemClean/templates/actor/partials/skills.html","systems/cyphersystemClean/templates/actor/partials/abilities.html","systems/cyphersystemClean/templates/actor/partials/inventory.html","systems/cyphersystemClean/templates/actor/partials/info/skill-info.html","systems/cyphersystemClean/templates/actor/partials/info/ability-info.html","systems/cyphersystemClean/templates/actor/partials/info/armor-info.html","systems/cyphersystemClean/templates/actor/partials/info/weapon-info.html","systems/cyphersystemClean/templates/actor/partials/info/gear-info.html","systems/cyphersystemClean/templates/actor/partials/info/cypher-info.html","systems/cyphersystemClean/templates/actor/partials/info/artifact-info.html","systems/cyphersystemClean/templates/actor/partials/info/oddity-info.html","systems/cyphersystemClean/templates/item/item-sheet.html","systems/cyphersystemClean/templates/item/skill-sheet.html","systems/cyphersystemClean/templates/item/armor-sheet.html","systems/cyphersystemClean/templates/item/weapon-sheet.html","systems/cyphersystemClean/templates/item/gear-sheet.html","systems/cyphersystemClean/templates/item/cypher-sheet.html","systems/cyphersystemClean/templates/item/artifact-sheet.html","systems/cyphersystemClean/templates/item/oddity-sheet.html"],e.abrupt("return",loadTemplates(t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})();r.preloadHandlebarsTemplates=l},{"@babel/runtime/helpers/asyncToGenerator":20,"@babel/runtime/helpers/interopRequireDefault":26,"@babel/runtime/regenerator":36}],16:[function(e,t,r){"use strict";function a(e){return!(null==e)}Object.defineProperty(r,"__esModule",{value:!0}),r.deepProp=function(e,t){var r=t.split("."),a=e;return r.forEach((function(e){e in a&&(a=a[e])})),a},r.isDefined=a,r.valOrDefault=function(e,t){return a(e)?e:t}},{}],17:[function(e,t,r){t.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}},{}],18:[function(e,t,r){t.exports=function(e){if(Array.isArray(e))return e}},{}],19:[function(e,t,r){t.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},{}],20:[function(e,t,r){function a(e,t,r,a,n,i,l){try{var s=e[i](l),o=s.value}catch(e){return void r(e)}s.done?t(o):Promise.resolve(o).then(a,n)}t.exports=function(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var l=e.apply(t,r);function s(e){a(l,n,i,s,o,"next",e)}function o(e){a(l,n,i,s,o,"throw",e)}s(void 0)})}}},{}],21:[function(e,t,r){t.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},{}],22:[function(e,t,r){function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}t.exports=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}},{}],23:[function(e,t,r){var a=e("./superPropBase");function n(e,r,i){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=n=Reflect.get:t.exports=n=function(e,t,r){var n=a(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}},n(e,r,i||e)}t.exports=n},{"./superPropBase":32}],24:[function(e,t,r){function a(e){return t.exports=a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}t.exports=a},{}],25:[function(e,t,r){var a=e("./setPrototypeOf");t.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}},{"./setPrototypeOf":30}],26:[function(e,t,r){t.exports=function(e){return e&&e.__esModule?e:{default:e}}},{}],27:[function(e,t,r){t.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],a=!0,n=!1,i=void 0;try{for(var l,s=e[Symbol.iterator]();!(a=(l=s.next()).done)&&(r.push(l.value),!t||r.length!==t);a=!0);}catch(e){n=!0,i=e}finally{try{a||null==s.return||s.return()}finally{if(n)throw i}}return r}}},{}],28:[function(e,t,r){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},{}],29:[function(e,t,r){var a=e("../helpers/typeof"),n=e("./assertThisInitialized");t.exports=function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?n(e):t}},{"../helpers/typeof":33,"./assertThisInitialized":19}],30:[function(e,t,r){function a(e,r){return t.exports=a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,r)}t.exports=a},{}],31:[function(e,t,r){var a=e("./arrayWithHoles"),n=e("./iterableToArrayLimit"),i=e("./unsupportedIterableToArray"),l=e("./nonIterableRest");t.exports=function(e,t){return a(e)||n(e,t)||i(e,t)||l()}},{"./arrayWithHoles":18,"./iterableToArrayLimit":27,"./nonIterableRest":28,"./unsupportedIterableToArray":34}],32:[function(e,t,r){var a=e("./getPrototypeOf");t.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=a(e)););return e}},{"./getPrototypeOf":24}],33:[function(e,t,r){function a(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=a=function(e){return typeof e}:t.exports=a=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}t.exports=a},{}],34:[function(e,t,r){var a=e("./arrayLikeToArray");t.exports=function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}},{"./arrayLikeToArray":17}],35:[function(e,t,r){var a=(function(e){"use strict";var t,r=Object.prototype,a=r.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",l=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function o(e,t,r,a){var n=t&&t.prototype instanceof m?t:m,i=Object.create(n.prototype),l=new x(a||[]);return i._invoke=(function(e,t,r){var a=c;return function(n,i){if(a===p)throw new Error("Generator is already running");if(a===d){if("throw"===n)throw i;return I()}for(r.method=n,r.arg=i;;){var l=r.delegate;if(l){var s=S(l,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===c)throw a=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=p;var o=u(e,t,r);if("normal"===o.type){if(a=r.done?d:f,o.arg===h)continue;return{value:o.arg,done:r.done}}"throw"===o.type&&(a=d,r.method="throw",r.arg=o.arg)}}})(e,r,l),i}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=o;var c="suspendedStart",f="suspendedYield",p="executing",d="completed",h={};function m(){}function y(){}function v(){}var b={};b[i]=function(){return this};var g=Object.getPrototypeOf,k=g&&g(g(O([])));k&&k!==r&&a.call(k,i)&&(b=k);var w=v.prototype=m.prototype=Object.create(b);function C(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function D(e,t){var r;this._invoke=function(n,i){function l(){return new t(function(r,l){!(function r(n,i,l,s){var o=u(e[n],e,i);if("throw"!==o.type){var c=o.arg,f=c.value;return f&&"object"==typeof f&&a.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,l,s)}),(function(e){r("throw",e,l,s)})):t.resolve(f).then((function(e){c.value=e,l(c)}),(function(e){return r("throw",e,l,s)}))}s(o.arg)})(n,i,r,l)})}return r=r?r.then(l,l):l()}}function S(e,r){var a=e.iterator[r.method];if(a===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method))return h;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var n=u(a,e.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,h;var i=n.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function O(e){if(e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,l=function r(){for(;++n<e.length;)if(a.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return l.next=l}}return{next:I}}function I(){return{value:t,done:!0}}return y.prototype=w.constructor=v,v.constructor=y,v[s]=y.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},C(D.prototype),D.prototype[l]=function(){return this},e.AsyncIterator=D,e.async=function(t,r,a,n,i){void 0===i&&(i=Promise);var l=new D(o(t,r,a,n),i);return e.isGeneratorFunction(r)?l:l.next().then((function(e){return e.done?e.value:l.next()}))},C(w),w[s]="Generator",w[i]=function(){return this},w.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var a=t.pop();if(a in e)return r.value=a,r.done=!1,r}return r.done=!0,r}},e.values=O,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(a,n){return s.type="throw",s.arg=e,r.next=a,n&&(r.method="next",r.arg=t),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var l=this.tryEntries[i],s=l.completion;if("root"===l.tryLoc)return n("end");if(l.tryLoc<=this.prev){var o=a.call(l,"catchLoc"),u=a.call(l,"finallyLoc");if(o&&u){if(this.prev<l.catchLoc)return n(l.catchLoc,!0);if(this.prev<l.finallyLoc)return n(l.finallyLoc)}else if(o){if(this.prev<l.catchLoc)return n(l.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<l.finallyLoc)return n(l.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var l=i?i.completion:{};return l.type=e,l.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(l)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var a=r.completion;if("throw"===a.type){var n=a.arg;R(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,a){return this.delegate={iterator:O(e),resultName:r,nextLoc:a},"next"===this.method&&(this.arg=t),h}},e})("object"==typeof t?t.exports:{});try{regeneratorRuntime=a}catch(e){Function("r","regeneratorRuntime = r")(a)}},{}],36:[function(e,t,r){t.exports=e("regenerator-runtime")},{"regenerator-runtime":35}]},{},[4]);