/*! cyphersystem v1.0.0 | (c) 2020 Cornell Daly | MIT License | https://github.com/bojjenclon/ */

!(function(){return function e(t,r,a){function n(o,l){if(!r[o]){if(!t[o]){var s="function"==typeof require&&require;if(!l&&s)return s(o,!0);if(i)return i(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[o]={exports:{}};t[o][0].call(u.exports,(function(e){return n(t[o][1][e]||e)}),u,u.exports,e,t,r,a)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<a.length;o++)n(a[o]);return n}})()({1:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.CypherSystemActorSheet=void 0;var n=a(e("@babel/runtime/helpers/slicedToArray")),i=a(e("@babel/runtime/regenerator")),o=a(e("@babel/runtime/helpers/asyncToGenerator")),l=a(e("@babel/runtime/helpers/classCallCheck")),s=a(e("@babel/runtime/helpers/createClass")),c=a(e("@babel/runtime/helpers/inherits")),u=a(e("@babel/runtime/helpers/possibleConstructorReturn")),f=a(e("@babel/runtime/helpers/get")),p=a(e("@babel/runtime/helpers/getPrototypeOf")),d=e("../config.js"),m=e("../rolls.js"),h=e("../item/item.js"),y=e("../utils.js"),v=a(e("../enums/enum-pool.js"));function b(e){var t=(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}})();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,u.default)(this,r)}}var g=(function(e){(0,c.default)(r,e);var t=b(r);function r(){var e;(0,l.default)(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];switch((e=t.call.apply(t,[this].concat(n))).actor.data.type){case"pc":e._pcInit();break;case"npc":e._npcInit()}return e}return(0,s.default)(r,[{key:"_pcInit",value:function(){this.skillsPoolFilter=-1,this.skillsTrainingFilter=-1,this.selectedSkill=null,this.abilityPoolFilter=-1,this.selectedAbility=null,this.inventoryTypeFilter=-1,this.selectedInvItem=null,this.filterEquipped=!1}},{key:"_npcInit",value:function(){}},{key:"template",get:function(){var e=this.actor.data.type;return"systems/cyphersystem/templates/actor/".concat(e,"-sheet.html")}}],[{key:"defaultOptions",get:function(){return mergeObject((0,f.default)((0,p.default)(r),"defaultOptions",this),{classes:["cyphersystem","sheet","actor"],width:600,height:500,tabs:[{navSelector:".sheet-tabs",contentSelector:".sheet-body",initial:"description"},{navSelector:".stats-tabs",contentSelector:".stats-body",initial:"advancement"}],scrollY:[".tab.inventory .inventory-list",".tab.inventory .inventory-info"]})}}]),(0,s.default)(r,[{key:"_generateItemData",value:function(e,t,r){var a=e.data.items;a[r]||(a[r]=a.filter((function(e){return e.type===t})))}},{key:"_filterItemData",value:function(e,t,r,a){var n=e.data.items;n[t]=n[t].filter((function(e){return(0,y.deepProp)(e,r)===a}))}},{key:"_skillData",value:(function(){var e=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._generateItemData(t,"skill","skills"),t.data.items.skills.sort((function(e,t){return e.data.pool===t.data.pool?e.name>t.name?1:-1:e.data.pool>t.data.pool?1:-1})),t.skillsPoolFilter=this.skillsPoolFilter,t.skillsTrainingFilter=this.skillsTrainingFilter,t.skillsPoolFilter>-1&&this._filterItemData(t,"skills","data.pool",parseInt(t.skillsPoolFilter,10)),t.skillsTrainingFilter>-1&&this._filterItemData(t,"skills","data.training",parseInt(t.skillsTrainingFilter,10)),t.selectedSkill=this.selectedSkill,t.skillInfo="",!t.selectedSkill){e.next=12;break}return e.next=11,t.selectedSkill.getInfo();case 11:t.skillInfo=e.sent;case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}})()},{key:"_abilityData",value:(function(){var e=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._generateItemData(t,"ability","abilities"),t.data.items.abilities.sort((function(e,t){return e.data.cost.pool===t.data.cost.pool?e.name>t.name?1:-1:e.data.cost.pool>t.data.cost.pool?1:-1})),t.abilityPoolFilter=this.abilityPoolFilter,t.abilityPoolFilter>-1&&this._filterItemData(t,"abilities","data.cost.pool",parseInt(t.abilityPoolFilter,10)),t.selectedAbility=this.selectedAbility,t.abilityInfo="",!t.selectedAbility){e.next=10;break}return e.next=9,t.selectedAbility.getInfo();case 9:t.abilityInfo=e.sent;case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}})()},{key:"_inventoryData",value:(function(){var e=(0,o.default)(i.default.mark((function e(t){var r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.inventoryTypes=d.CSR.inventoryTypes,(r=t.data.items).inventory||(r.inventory=r.filter((function(e){return d.CSR.inventoryTypes.includes(e.type)})),this.filterEquipped&&(r.inventory=r.inventory.filter((function(e){return!!e.data.equipped}))),r.inventory.sort((function(e,t){return e.type===t.type?e.name>t.name?1:-1:e.type>t.type?1:-1}))),t.cypherCount=r.reduce((function(e,t){return"cypher"===t.type?++e:e}),0),t.overCypherLimit=this.actor.isOverCypherLimit,t.inventoryTypeFilter=this.inventoryTypeFilter,t.filterEquipped=this.filterEquipped,t.inventoryTypeFilter>-1&&this._filterItemData(t,"inventory","type",d.CSR.inventoryTypes[parseInt(t.inventoryTypeFilter,10)]),t.selectedInvItem=this.selectedInvItem,t.invItemInfo="",!t.selectedInvItem){e.next=14;break}return e.next=13,t.selectedInvItem.getInfo();case 13:t.invItemInfo=e.sent;case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}})()},{key:"_pcData",value:(function(){var e=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isGM=game.user.isGM,t.currencyName=game.settings.get("cyphersystem","currencyName"),t.ranges=d.CSR.ranges,t.stats=d.CSR.stats,t.weaponTypes=d.CSR.weaponTypes,t.weights=d.CSR.weightClasses,t.advances=Object.entries(t.actor.data.advances).map((function(e){var t=(0,n.default)(e,2),r=t[0],a=t[1];return{name:r,label:game.i18n.localize("CSR.advance.".concat(r)),isChecked:a}})),t.damageTrackData=d.CSR.damageTrack,t.damageTrack=d.CSR.damageTrack[t.data.damageTrack],t.recoveriesData=Object.entries(t.actor.data.recoveries).map((function(e){var t=(0,n.default)(e,2),r=t[0],a=t[1];return{key:r,label:game.i18n.localize("CSR.recovery.".concat(r)),checked:a}})),t.trainingLevels=d.CSR.trainingLevels,t.data.items=t.actor.items||{},e.next=14,this._skillData(t);case 14:return e.next=16,this._abilityData(t);case 16:return e.next=18,this._inventoryData(t);case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}})()},{key:"_npcData",value:(function(){var e=(0,o.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.ranges=d.CSR.ranges;case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}})()},{key:"getData",value:(function(){var e=(0,o.default)(i.default.mark((function e(){var t,a;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,f.default)((0,p.default)(r.prototype),"getData",this).call(this),a=this.actor.data.type,e.t0=a,e.next="pc"===e.t0?5:"npc"===e.t0?8:11;break;case 5:return e.next=7,this._pcData(t);case 7:return e.abrupt("break",11);case 8:return e.next=10,this._npcData(t);case 10:return e.abrupt("break",11);case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()},{key:"_createItem",value:function(e){var t={name:"New ".concat(e.capitalize()),type:e,data:new h.CypherSystemItem({})};this.actor.createOwnedItem(t,{renderSheet:!0})}},{key:"_rollPoolDialog",value:function(e){var t=this.actor,r=t.data.data,a=v.default[e],n=t.getFreeEffortFromStat(e);(0,m.cypherRoll)({parts:["1d20"],data:{pool:e,effort:n,maxEffort:r.effort},event:event,title:game.i18n.localize("CSR.roll.pool.title").replace("##POOL##",a),flavor:game.i18n.localize("CSR.roll.pool.flavor").replace("##ACTOR##",t.name).replace("##POOL##",a),actor:t,speaker:ChatMessage.getSpeaker({actor:t})})}},{key:"_rollRecovery",value:function(){var e=this.actor,t=e.data.data,r=new Roll("1d6+".concat(t.recoveryMod)).roll();r.dice[0].options.recovery=!0,r.toMessage({title:game.i18n.localize("CSR.roll.recovery.title"),speaker:ChatMessage.getSpeaker({actor:e}),flavor:game.i18n.localize("CSR.roll.recovery.flavor").replace("##ACTOR##",e.name)})}},{key:"_deleteItemDialog",value:function(e,t){var r=this;new Dialog({title:game.i18n.localize("CSR.dialog.delete.title"),content:"<p>".concat(game.i18n.localize("CSR.dialog.delete.content"),"</p><hr />"),buttons:{confirm:{icon:'<i class="fas fa-check"></i>',label:game.i18n.localize("CSR.dialog.button.delete"),callback:function(){r.actor.deleteOwnedItem(e),t&&t(!0)}},cancel:{icon:'<i class="fas fa-times"></i>',label:game.i18n.localize("CSR.dialog.button.cancel"),callback:function(){t&&t(!1)}}},default:"cancel"}).render(!0)}},{key:"_statsTabListeners",value:function(e){var t=this,r=e.find(".roll-pool");if(r.click((function(e){e.preventDefault();for(var r=e.target;!r.dataset.pool;)r=r.parentElement;var a=r.dataset.pool;t._rollPoolDialog(parseInt(a,10))})),this.actor.owner){var a=function(e){e.dataTransfer.setData("text/plain",JSON.stringify({actorId:t.actor.id,data:{type:"pool",pool:e.currentTarget.dataset.pool}}))};r.each((function(e,t){t.setAttribute("draggable",!0),t.addEventListener("dragstart",a,!1)}))}e.find('select[name="data.damageTrack"]').select2({theme:"numenera",width:"130px",minimumResultsForSearch:1/0}),e.find(".recovery-roll").click((function(e){e.preventDefault(),t._rollRecovery()}))}},{key:"_skillsTabListeners",value:function(e){var t=this;e.find(".add-skill").click((function(e){e.preventDefault(),t._createItem("skill")})),e.find('select[name="skillsPoolFilter"]').select2({theme:"numenera",width:"130px",minimumResultsForSearch:1/0}).on("change",(function(e){t.skillsPoolFilter=e.target.value,t.selectedSkill=null})),e.find('select[name="skillsTrainingFilter"]').select2({theme:"numenera",width:"130px",minimumResultsForSearch:1/0}).on("change",(function(e){t.skillsTrainingFilter=e.target.value}));var r=e.find("a.skill");if(r.on("click",(function(e){e.preventDefault();for(var r=e.target;!r.dataset.itemId;)r=r.parentElement;var a=r.dataset.itemId,n=t.actor.getOwnedItem(a);t.selectedSkill=n,t.render(!0)})),this.actor.owner){var a=function(e){return t._onDragItemStart(e)};r.each((function(e,t){t.setAttribute("draggable",!0),t.addEventListener("dragstart",a,!1)}))}var n=this.selectedSkill;n&&(e.find(".skill-info .actions .roll").click((function(e){e.preventDefault(),n.roll()})),e.find(".skill-info .actions .edit").click((function(e){e.preventDefault(),t.selectedSkill.sheet.render(!0)})),e.find(".skill-info .actions .delete").click((function(e){e.preventDefault(),t._deleteItemDialog(t.selectedSkill._id,(function(e){e&&(t.selectedSkill=null)}))})))}},{key:"_abilityTabListeners",value:function(e){var t=this;e.find(".add-ability").click((function(e){e.preventDefault(),t._createItem("ability")})),e.find('select[name="abilityPoolFilter"]').select2({theme:"numenera",width:"130px",minimumResultsForSearch:1/0}).on("change",(function(e){t.abilityPoolFilter=e.target.value,t.selectedAbility=null}));var r=e.find("a.ability");if(r.on("click",(function(e){e.preventDefault();for(var r=e.target;!r.dataset.itemId;)r=r.parentElement;var a=r.dataset.itemId,n=t.actor.getOwnedItem(a);t.selectedAbility=n,t.render(!0)})),this.actor.owner){var a=function(e){return t._onDragItemStart(e)};r.each((function(e,t){t.setAttribute("draggable",!0),t.addEventListener("dragstart",a,!1)}))}var n=this.selectedAbility;n&&(e.find(".ability-info .actions .roll").click((function(e){e.preventDefault(),n.roll()})),e.find(".ability-info .actions .edit").click((function(e){e.preventDefault(),t.selectedAbility.sheet.render(!0)})),e.find(".ability-info .actions .delete").click((function(e){e.preventDefault(),t._deleteItemDialog(t.selectedAbility._id,(function(e){e&&(t.selectedAbility=null)}))})))}},{key:"_inventoryTabListeners",value:function(e){var t=this,r=e.find(".contextmenu"),a=e.find(".add-inventory"),n=[];d.CSR.inventoryTypes.forEach((function(e){n.push({name:game.i18n.localize("CSR.inventory.".concat(e)),icon:"",callback:function(){t._createItem(e)}})}));var i=new ContextMenu(e,".active",n);a.click((function(e){e.preventDefault(),r.offset(a.offset()),i.render(r.find(".container"))})),e.on("mousedown",(function(e){e.target!==a[0]&&i.close()})),e.find('select[name="inventoryTypeFilter"]').select2({theme:"numenera",width:"130px",minimumResultsForSearch:1/0}).on("change",(function(e){t.inventoryTypeFilter=e.target.value,t.selectedInvItem=null})),e.find(".filter-equipped").click((function(e){e.preventDefault(),t.filterEquipped=!t.filterEquipped,t.render(!0)}));var o=e.find("a.inv-item");if(o.on("click",(function(e){e.preventDefault();for(var r=e.target;!r.dataset.itemId;)r=r.parentElement;var a=r.dataset.itemId,n=t.actor.getOwnedItem(a);t.selectedInvItem=n,t.render(!0)})),this.actor.owner){var l=function(e){return t._onDragItemStart(e)};o.each((function(e,t){t.setAttribute("draggable",!0),t.addEventListener("dragstart",l,!1)}))}this.selectedInvItem&&(e.find(".inventory-info .actions .edit").click((function(e){e.preventDefault(),t.selectedInvItem.sheet.render(!0)})),e.find(".inventory-info .actions .delete").click((function(e){e.preventDefault(),t._deleteItemDialog(t.selectedInvItem._id,(function(e){e&&(t.selectedInvItem=null)}))})))}},{key:"_pcListeners",value:function(e){e.closest(".window-app.sheet.actor").addClass("pc-window"),e.find('.item[data-tab="stats"]').click((function(){var t=e.find(".stats-tabs .item.active").first(),r=e.find('.stats-body .tab[data-tab="'.concat(t.data("tab"),'"]'));setTimeout((function(){r.addClass("active")}),0)})),this._statsTabListeners(e),this._skillsTabListeners(e),this._abilityTabListeners(e),this._inventoryTabListeners(e)}},{key:"_npcListeners",value:function(e){e.closest(".window-app.sheet.actor").addClass("npc-window"),e.find('select[name="data.movement"]').select2({theme:"numenera",width:"120px",minimumResultsForSearch:1/0})}},{key:"activateListeners",value:function(e){if((0,f.default)((0,p.default)(r.prototype),"activateListeners",this).call(this,e),this.options.editable)switch(this.actor.data.type){case"pc":this._pcListeners(e);break;case"npc":this._npcListeners(e)}}},{key:"_onDragItemStart",value:function(e){var t=e.currentTarget.dataset.itemId,a=this.actor.getEmbeddedEntity("OwnedItem",t);return e.dataTransfer.setData("text/plain",JSON.stringify({actorId:this.actor.id,data:a})),(0,f.default)((0,p.default)(r.prototype),"_onDragItemStart",this).call(this,e)}}]),r})(ActorSheet);r.CypherSystemActorSheet=g},{"../config.js":5,"../enums/enum-pool.js":11,"../item/item.js":18,"../rolls.js":22,"../utils.js":26,"@babel/runtime/helpers/asyncToGenerator":30,"@babel/runtime/helpers/classCallCheck":31,"@babel/runtime/helpers/createClass":32,"@babel/runtime/helpers/get":33,"@babel/runtime/helpers/getPrototypeOf":34,"@babel/runtime/helpers/inherits":35,"@babel/runtime/helpers/interopRequireDefault":36,"@babel/runtime/helpers/possibleConstructorReturn":39,"@babel/runtime/helpers/slicedToArray":41,"@babel/runtime/regenerator":45}],2:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.CypherSystemActor=void 0;var n=a(e("@babel/runtime/regenerator")),i=a(e("@babel/runtime/helpers/asyncToGenerator")),o=a(e("@babel/runtime/helpers/classCallCheck")),l=a(e("@babel/runtime/helpers/createClass")),s=a(e("@babel/runtime/helpers/get")),c=a(e("@babel/runtime/helpers/inherits")),u=a(e("@babel/runtime/helpers/possibleConstructorReturn")),f=a(e("@babel/runtime/helpers/getPrototypeOf")),p=e("../config.js"),d=e("../utils.js"),m=e("../dialog/player-choice-dialog.js"),h=a(e("../enums/enum-pool.js"));function y(e){var t=(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}})();return function(){var r,a=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,u.default)(this,r)}}var v=(function(e){(0,c.default)(r,e);var t=y(r);function r(){return(0,o.default)(this,r),t.apply(this,arguments)}return(0,l.default)(r,[{key:"_preparePCData",value:function(e){var t=e.data;t.sentence=(0,d.valOrDefault)(t.sentence,{descriptor:"",type:"",focus:""}),t.tier=(0,d.valOrDefault)(t.tier,1),t.effort=(0,d.valOrDefault)(t.effort,1),t.xp=(0,d.valOrDefault)(t.xp,0),t.cypherLimit=(0,d.valOrDefault)(t.cypherLimit,1),t.advances=(0,d.valOrDefault)(t.advances,{stats:!1,edge:!1,effort:!1,skills:!1,other:!1}),t.recoveryMod=(0,d.valOrDefault)(t.recoveryMod,1),t.recoveries=(0,d.valOrDefault)(t.recoveries,{action:!1,tenMins:!1,oneHour:!1,tenHours:!1}),t.damageTrack=(0,d.valOrDefault)(t.damageTrack,0),t.armor=(0,d.valOrDefault)(t.armor,0),t.stats=(0,d.valOrDefault)(t.stats,{might:{value:0,pool:0,edge:0},speed:{value:0,pool:0,edge:0},intellect:{value:0,pool:0,edge:0}}),t.money=(0,d.valOrDefault)(t.money,0)}},{key:"_prepareNPCData",value:function(e){var t=e.data;t.level=(0,d.valOrDefault)(t.level,1),t.health=(0,d.valOrDefault)(t.health,3),t.damage=(0,d.valOrDefault)(t.damage,1),t.armor=(0,d.valOrDefault)(t.armor,0),t.movement=(0,d.valOrDefault)(t.movement,1),t.description=(0,d.valOrDefault)(t.description,""),t.motive=(0,d.valOrDefault)(t.motive,""),t.environment=(0,d.valOrDefault)(t.environment,""),t.modifications=(0,d.valOrDefault)(t.modifications,""),t.combat=(0,d.valOrDefault)(t.combat,""),t.interaction=(0,d.valOrDefault)(t.interaction,""),t.use=(0,d.valOrDefault)(t.use,""),t.loot=(0,d.valOrDefault)(t.loot,"")}},{key:"prepareData",value:function(){(0,s.default)((0,f.default)(r.prototype),"prepareData",this).call(this);var e=this.data;e.data,e.flags;switch(e.type){case"pc":this._preparePCData(e);break;case"npc":this._prepareNPCData(e)}}},{key:"getSkillLevel",value:function(e){return e.data.data.training-1}},{key:"getEffortCostFromStat",value:function(e,t){var r={cost:0,effortLevel:0,warning:null};if(0===t)return r;var a=this.data.data,n=h.default[e],i=a.stats[n.toLowerCase()],o=(i.value+i.edge-1)/2,l=Math.min(t,a.effort,o),s=1+2*l-i.edge,c=null;return t>o&&(c="Not enough points in your ".concat(n," pool for that level of Effort")),r.cost=s,r.effortLevel=l,r.warning=c,r}},{key:"getEdgeFromStat",value:function(e){var t=this.data.data,r=h.default[e];return t.stats[r.toLowerCase()].edge}},{key:"getFreeEffortFromStat",value:function(e){var t=this.getEdgeFromStat(e);return Math.max(Math.floor((t-1)/2),0)}},{key:"canSpendFromPool",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=this.data.data,n=h.default[e].toLowerCase(),i=a.stats[n],o=i.value;return(r?t-i.edge:t)<=o}},{key:"spendFromPool",value:function(e,t){if(!this.canSpendFromPool(e,t))return!1;var r=this.data.data,a=h.default[e],n=r.stats[a.toLowerCase()],i={};return i["data.stats.".concat(a.toLowerCase(),".value")]=Math.max(0,n.value-t),this.update(i),!0}},{key:"onGMIntrusion",value:(function(){var e=(0,i.default)(n.default.mark((function e(t){var r,a,i,o=this;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.data.data.xp,a="<h2>".concat(game.i18n.localize("CSR.intrusion.chat.heading"),"</h2><br>"),t?(r++,a+=game.i18n.localize("CSR.intrusion.chat.accept").replace("##ACTOR##",this.data.name)):(r--,a+=game.i18n.localize("CSR.intrusion.chat.refuse").replace("##ACTOR##",this.data.name)),this.update({_id:this._id,"data.xp":r}),ChatMessage.create({content:a}),t&&(i=game.actors.filter((function(e){return e._id!==o._id&&"pc"===e.data.type})),new m.PlayerChoiceDialog(i,function(e){game.socket.emit("system.cyphersystem",{type:"awardXP",data:{actorId:e,xpAmount:1}})}).render(!0));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}})()},{key:"createEmbeddedEntity",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t,a,i,o,l,c,u=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=u.length,i=new Array(a),o=0;o<a;o++)i[o]=u[o];if(i[0],!(l=i[1]).data||!p.CSR.hasLevelDie.includes(l.type)){e.next=17;break}if((c=l.data).level||!c.levelDie){e.next=16;break}return e.prev=5,c.level=new Roll(c.levelDie).roll().total,e.next=9,this.update({_id:this._id,"data.level":c.level});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),c.level=c.level||null;case 14:e.next=17;break;case 16:c.level=c.level||null;case 17:return e.abrupt("return",(t=(0,s.default)((0,f.default)(r.prototype),"createEmbeddedEntity",this)).call.apply(t,[this].concat(i)));case 18:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(){return e.apply(this,arguments)}})()},{key:"initiativeLevel",get:function(){return this.data.items.filter((function(e){return"skill"===e.type&&e.data.flags.initiative}))[0].data.training-1}},{key:"canRefuseIntrusion",get:function(){return this.data.data.xp>0}},{key:"isOverCypherLimit",get:function(){var e=this.getEmbeddedCollection("OwnedItem").filter((function(e){return"cypher"===e.type}));return this.data.data.cypherLimit<e.length}}]),r})(Actor);r.CypherSystemActor=v},{"../config.js":5,"../dialog/player-choice-dialog.js":9,"../enums/enum-pool.js":11,"../utils.js":26,"@babel/runtime/helpers/asyncToGenerator":30,"@babel/runtime/helpers/classCallCheck":31,"@babel/runtime/helpers/createClass":32,"@babel/runtime/helpers/get":33,"@babel/runtime/helpers/getPrototypeOf":34,"@babel/runtime/helpers/inherits":35,"@babel/runtime/helpers/interopRequireDefault":36,"@babel/runtime/helpers/possibleConstructorReturn":39,"@babel/runtime/regenerator":45}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.renderChatMessage=function(e,t,r){if(e.roll&&!e.roll.dice[0].options.recovery){var n=e.roll.dice[0].results[0].result,i=e.roll.total,o=(0,a.rollText)(n,i),l=o.length,s=$("<div/>");s.addClass("special-messages"),o.forEach((function(e,t){var r=e.text,a=e.color,n=e.cls,i='<span class="'.concat(n,'" style="color: ').concat(a,'">').concat(r,"</span>").concat(t<l-1?"<br />":"");s.append(i)}));var c=t.find(".dice-total");s.insertBefore(c)}};var a=e("./rolls.js")},{"./rolls.js":22}],4:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.rollInitiative=function(e){return s.apply(this,arguments)};var n=a(e("@babel/runtime/regenerator")),i=a(e("@babel/runtime/helpers/asyncToGenerator"));function o(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=(function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)})(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function s(){return(s=(0,i.default)(n.default.mark((function e(t){var r,a,i,l,s,c,u,f,p,d,m,h,y,v,b,g,k,w,C,S,D,R,_=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_.length>1&&void 0!==_[1]?_[1]:null,r=_.length>2&&void 0!==_[2]?_[2]:{},a=[],i=[],l=o(t="string"==typeof t?[t]:t),e.prev=6,l.s();case 8:if((s=l.n()).done){e.next=37;break}return c=s.value,e.next=12,this.getCombatant(c);case 12:if(!(u=e.sent).defeated){e.next=15;break}return e.abrupt("return");case 15:f=u.actor,p=f.data,d=p.type,m=void 0,h=void 0,e.t0=d,e.next="pc"===e.t0?23:"npc"===e.t0?30:33;break;case 23:return y=f.initiativeLevel,v=y<0?"-":"+",b="1d20"+(0===y?"":"".concat(v).concat(3*Math.abs(y))),g=new Roll(b).roll(),m=Math.max(g.total,0),h=g.result,e.abrupt("break",33);case 30:return k=p.data.level,m=3*k,e.abrupt("break",33);case 33:a.push({_id:u._id,initiative:m}),"pc"===d&&(w=u.token,C=w.hidden||u.hidden,S=C?game.users.entities.filter((function(e){return e.isGM})):"",D='\n        <div class="dice-roll">\n          <div class="dice-result">\n            <div class="dice-formula">'.concat(h,'</div>\n            <div class="dice-tooltip">\n              <section class="tooltip-part">\n                <div class="dice">\n                  <p class="part-formula">\n                    1d20\n                    <span class="part-total">').concat(m,'</span>\n                  </p>\n\n                  <ol class="dice-rolls">\n                    <li class="roll die d20">').concat(m,'</li>\n                  </ol>\n                </div>\n              </section>\n            </div>\n            <div class="dice-total">').concat(m,"</div>\n          </div>\n        </div>\n        "),R=mergeObject({speaker:{scene:canvas.scene._id,actor:f?f._id:null,token:w._id,alias:w.name},whisper:S,flavor:game.i18n.localize("CSR.initiative.flavor").replace("##ACTOR##",w.name),content:D},r),i.push(R));case 35:e.next=8;break;case 37:e.next=42;break;case 39:e.prev=39,e.t1=e.catch(6),l.e(e.t1);case 42:return e.prev=42,l.f(),e.finish(42);case 45:if(a.length){e.next=47;break}return e.abrupt("return");case 47:return e.next=49,this.updateEmbeddedEntity("Combatant",a);case 49:return ChatMessage.create(i),e.abrupt("return",this);case 51:case"end":return e.stop()}}),e,this,[[6,39,42,45]])})))).apply(this,arguments)}},{"@babel/runtime/helpers/asyncToGenerator":30,"@babel/runtime/helpers/interopRequireDefault":36,"@babel/runtime/regenerator":45}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CSR=void 0;var a={};r.CSR=a,a.itemTypes=["skills","abilities","cyphers","artifacts","oddities","weapons","armor","gear"],a.inventoryTypes=["weapon","armor","gear","cypher","artifact","oddity"],a.weightClasses=["light","medium","heavy"],a.weaponTypes=["bashing","bladed","ranged"],a.stats=["might","speed","intellect"],a.trainingLevels=["inability","untrained","trained","specialized"],a.damageTrack=["hale","impaired","debilitated","dead"],a.recoveries=["action","tenMins","oneHour","tenHours"],a.advances=["stats","edge","effort","skills","other"],a.ranges=["immediate","short","long","veryLong"],a.optionalRanges=["na"].concat(a.ranges),a.abilityTypes=["action","enabler"],a.supportsMacros=["skill","ability"],a.hasLevelDie=["cypher","artifact"]},{}],6:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.actorDirectoryContext=function(e,t){t.push({name:game.i18n.localize("CSR.ctxt.intrusion.heading"),icon:'<i class="fas fa-exclamation-circle"></i>',callback:function(e){var t=game.actors.get(e.data("entityId")),r=Object.entries(t.data.permission).filter((function(e){var t=(0,n.default)(e,2),r=t[0],a=t[1];return a>=ENTITY_PERMISSIONS.OWNER&&r!==game.user.id})).map((function(e){return e[0]}));game.socket.emit("system.cyphersystem",{type:"gmIntrusion",data:{userIds:r,actorId:t.data._id}});var a=game.i18n.localize("CSR.ctxt.intrusion.heading"),i=game.i18n.localize("CSR.ctxt.intrusion.heading").replace("##ACTOR##",t.data.name);ChatMessage.create({content:"<h2>".concat(a,"</h2><br/>").concat(i)})},condition:function(e){if(!game.user.isGM)return!1;var t=game.actors.get(e.data("entityId"));return t&&"pc"===t.data.type}})};var n=a(e("@babel/runtime/helpers/slicedToArray"))},{"@babel/runtime/helpers/interopRequireDefault":36,"@babel/runtime/helpers/slicedToArray":41}],7:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault"),n=a(e("@babel/runtime/regenerator")),i=a(e("@babel/runtime/helpers/asyncToGenerator")),o=e("./actor/actor.js"),l=e("./actor/actor-sheet.js"),s=e("./item/item.js"),c=e("./item/item-sheet.js"),u=e("./handlebars-helpers.js"),f=e("./template.js"),p=e("./settings.js"),d=e("./chat.js"),m=e("./context-menu.js"),h=e("./migrations/migrate"),y=e("./socket.js"),v=e("./combat.js"),b=e("./macros.js");Hooks.once("init",(0,i.default)(n.default.mark((function e(){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:game.cyphersystem={CypherSystemActor:o.CypherSystemActor,CypherSystemItem:s.CypherSystemItem,macro:{usePool:b.usePoolMacro,useSkill:b.useSkillMacro,useAbility:b.useAbilityMacro,useCypher:b.useCypherMacro}},Combat.prototype.rollInitiative=v.rollInitiative,CONFIG.Actor.entityClass=o.CypherSystemActor,CONFIG.Item.entityClass=s.CypherSystemItem,Actors.unregisterSheet("core",ActorSheet),Actors.registerSheet("cyphersystem",l.CypherSystemActorSheet,{types:["pc"],makeDefault:!0}),Actors.registerSheet("cyphersystem",l.CypherSystemActorSheet,{types:["npc"],makeDefault:!0}),Items.unregisterSheet("core",ItemSheet),Items.registerSheet("cyphersystem",c.CypherSystemItemSheet,{makeDefault:!0}),(0,p.registerSystemSettings)(),(0,u.registerHandlebarHelpers)(),(0,f.preloadHandlebarsTemplates)();case 12:case"end":return e.stop()}}),e)})))),Hooks.on("renderChatMessage",d.renderChatMessage),Hooks.on("getActorDirectoryEntryContext",m.actorDirectoryContext),Hooks.on("createActor",(function(){var e=(0,i.default)(n.default.mark((function e(t){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"pc"===t.data.type&&t.createOwnedItem({name:game.i18n.localize("CSR.skill.initiative"),type:"skill",data:new s.CypherSystemItem({pool:1,training:1,"flags.initiative":!0})});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}})()),Hooks.once("ready",h.migrate),Hooks.once("ready",y.csrSocketListeners),Hooks.once("ready",(function(){Hooks.on("hotbarDrop",(function(e,t,r){return(0,b.createCypherMacro)(t,r)}))}))},{"./actor/actor-sheet.js":1,"./actor/actor.js":2,"./chat.js":3,"./combat.js":4,"./context-menu.js":6,"./handlebars-helpers.js":16,"./item/item-sheet.js":17,"./item/item.js":18,"./macros.js":19,"./migrations/migrate":20,"./settings.js":23,"./socket.js":24,"./template.js":25,"@babel/runtime/helpers/asyncToGenerator":30,"@babel/runtime/helpers/interopRequireDefault":36,"@babel/runtime/regenerator":45}],8:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.GMIntrusionDialog=void 0;var n=a(e("@babel/runtime/regenerator")),i=a(e("@babel/runtime/helpers/asyncToGenerator")),o=a(e("@babel/runtime/helpers/classCallCheck")),l=a(e("@babel/runtime/helpers/assertThisInitialized")),s=a(e("@babel/runtime/helpers/createClass")),c=a(e("@babel/runtime/helpers/inherits")),u=a(e("@babel/runtime/helpers/possibleConstructorReturn")),f=a(e("@babel/runtime/helpers/get")),p=a(e("@babel/runtime/helpers/getPrototypeOf"));function d(e){var t=(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}})();return function(){var r,a=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,u.default)(this,r)}}var m=(function(e){(0,c.default)(r,e);var t=d(r);function r(e){var a,s,c,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,o.default)(this,r);var d=game.i18n.localize("CSR.dialog.intrusion.doYouAccept"),m=game.i18n.localize("CSR.dialog.intrusion.acceptInstructions").replace("##ACCEPT##",'<span style="color: green">'.concat(game.i18n.localize("CSR.accept"),"</span>")),h=game.i18n.localize("CSR.dialog.intrusion.refuseInstructions").replace("##REFUSE##",'<span style="color: red">'.concat(game.i18n.localize("CSR.refuse"),"</span>")),y='\n    <div class="row">\n      <div class="col-xs-12">\n        <p>'.concat(d,'</p>\n      </div>\n    </div>\n    <hr />\n    <div class="row">\n      <div class="col-xs-6">\n        <p>').concat(m,'</p>\n      </div>\n      <div class="col-xs-6">\n        <p>').concat(h,"</p>\n      </div>\n    </div>\n    <hr />"),v={ok:{icon:'<i class="fas fa-check" style="color: green"></i>',label:game.i18n.localize("CSR.dialog.button.accept"),callback:(function(){var t=(0,i.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onGMIntrusion(!0);case 2:(0,f.default)((a=(0,l.default)(c),(0,p.default)(r.prototype)),"close",a).call(a);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()},cancel:{icon:'<i class="fas fa-times" style="color: red"></i>',label:game.i18n.localize("CSR.dialog.button.refuse"),callback:(function(){var t=(0,i.default)(n.default.mark((function t(){return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onGMIntrusion(!1);case 2:(0,f.default)((s=(0,l.default)(c),(0,p.default)(r.prototype)),"close",s).call(s);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()}};if(!e.canRefuseIntrusion){var b=game.i18n.localize("CSR.dialog.intrusion.notEnoughXP");y+='\n      <div class="row">\n        <div class="col-xs-12">\n          <p><strong>'.concat(b,"</strong></p>\n        </div>\n      </div>\n      <hr />"),delete v.cancel}var g={title:game.i18n.localize("CSR.dialog.intrusion.title"),content:y,buttons:v,defaultYes:!1};return(c=t.call(this,g,u)).actor=e,c}return(0,s.default)(r,null,[{key:"defaultOptions",get:function(){return mergeObject((0,f.default)((0,p.default)(r),"defaultOptions",this),{template:"templates/hud/dialog.html",classes:["csr","dialog"],width:500})}}]),(0,s.default)(r,[{key:"_getHeaderButtons",value:function(){return[]}},{key:"close",value:function(){}}]),r})(Dialog);r.GMIntrusionDialog=m},{"@babel/runtime/helpers/assertThisInitialized":29,"@babel/runtime/helpers/asyncToGenerator":30,"@babel/runtime/helpers/classCallCheck":31,"@babel/runtime/helpers/createClass":32,"@babel/runtime/helpers/get":33,"@babel/runtime/helpers/getPrototypeOf":34,"@babel/runtime/helpers/inherits":35,"@babel/runtime/helpers/interopRequireDefault":36,"@babel/runtime/helpers/possibleConstructorReturn":39,"@babel/runtime/regenerator":45}],9:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.PlayerChoiceDialog=void 0;var n=a(e("@babel/runtime/helpers/classCallCheck")),i=a(e("@babel/runtime/helpers/assertThisInitialized")),o=a(e("@babel/runtime/helpers/createClass")),l=a(e("@babel/runtime/helpers/inherits")),s=a(e("@babel/runtime/helpers/possibleConstructorReturn")),c=a(e("@babel/runtime/helpers/get")),u=a(e("@babel/runtime/helpers/getPrototypeOf"));function f(e){var t=(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}})();return function(){var r,a=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,s.default)(this,r)}}var p=(function(e){(0,l.default)(r,e);var t=f(r);function r(e,a){var o,l,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,n.default)(this,r);var f=[];e.forEach((function(e){f.push('<option value="'.concat(e._id,'">').concat(e.name,"</option>"))}));var p=game.i18n.localize("CSR.dialog.player.content"),d='\n    <div class="row">\n      <div class="col-xs-12">\n        <p>'.concat(p,'</p>\n      </div>\n    </div>\n    <hr />\n    <div class="row">\n      <div class="col-xs-12">\n        <select name="player">\n          ').concat(f.join("\n"),"\n        </select>\n      </div>\n    </div>\n    <hr />"),m={ok:{icon:'<i class="fas fa-check"></i>',label:game.i18n.localize("CSR.dialog.button.accept"),callback:function(){var e=document.querySelector('.player-choice select[name="player"]').value;a(e),(0,c.default)((o=(0,i.default)(l),(0,u.default)(r.prototype)),"close",o).call(o)}}},h={title:game.i18n.localize("CSR.dialog.player.title"),content:d,buttons:m,defaultYes:!1};return(l=t.call(this,h,s)).actors=e,l}return(0,o.default)(r,null,[{key:"defaultOptions",get:function(){return mergeObject((0,c.default)((0,u.default)(r),"defaultOptions",this),{template:"templates/hud/dialog.html",classes:["csr","dialog","player-choice"],width:300,height:175})}}]),(0,o.default)(r,[{key:"getData",value:function(){var e=(0,c.default)((0,u.default)(r.prototype),"getData",this).call(this);return e.actors=this.actors,e}},{key:"activateListeners",value:function(e){(0,c.default)((0,u.default)(r.prototype),"activateListeners",this).call(this,e),e.find('select[name="player"]').select2({theme:"numenera",width:"100%"})}},{key:"_getHeaderButtons",value:function(){return[]}},{key:"close",value:function(){}}]),r})(Dialog);r.PlayerChoiceDialog=p},{"@babel/runtime/helpers/assertThisInitialized":29,"@babel/runtime/helpers/classCallCheck":31,"@babel/runtime/helpers/createClass":32,"@babel/runtime/helpers/get":33,"@babel/runtime/helpers/getPrototypeOf":34,"@babel/runtime/helpers/inherits":35,"@babel/runtime/helpers/interopRequireDefault":36,"@babel/runtime/helpers/possibleConstructorReturn":39}],10:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.RollDialog=void 0;var n=a(e("@babel/runtime/helpers/classCallCheck")),i=a(e("@babel/runtime/helpers/createClass")),o=a(e("@babel/runtime/helpers/get")),l=a(e("@babel/runtime/helpers/inherits")),s=a(e("@babel/runtime/helpers/possibleConstructorReturn")),c=a(e("@babel/runtime/helpers/getPrototypeOf"));function u(e){var t=(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}})();return function(){var r,a=(0,c.default)(e);if(t){var n=(0,c.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,s.default)(this,r)}}var f=(function(e){(0,l.default)(r,e);var t=u(r);function r(e,a){return(0,n.default)(this,r),t.call(this,e,a)}return(0,i.default)(r,[{key:"activateListeners",value:function(e){(0,o.default)((0,c.default)(r.prototype),"activateListeners",this).call(this,e),e.find('select[name="rollMode"]').select2({theme:"numenera",width:"135px",minimumResultsForSearch:1/0})}}]),r})(Dialog);r.RollDialog=f},{"@babel/runtime/helpers/classCallCheck":31,"@babel/runtime/helpers/createClass":32,"@babel/runtime/helpers/get":33,"@babel/runtime/helpers/getPrototypeOf":34,"@babel/runtime/helpers/inherits":35,"@babel/runtime/helpers/interopRequireDefault":36,"@babel/runtime/helpers/possibleConstructorReturn":39}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=["Might","Speed","Intellect"];r.default=a},{}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=["Immediate","Short","Long","Very Long"];r.default=a},{}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=["Inability","Untrained","Trained","Specialized"];r.default=a},{}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=["Bashing","Bladed","Ranged"];r.default=a},{}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=["Light","Medium","Heavy"];r.default=a},{}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.registerHandlebarHelpers=void 0;r.registerHandlebarHelpers=function(){Handlebars.registerHelper("toLowerCase",(function(e){return e.toLowerCase()})),Handlebars.registerHelper("toUpperCase",(function(e){return e.toUpperCase()})),Handlebars.registerHelper("eq",(function(e,t){return e===t})),Handlebars.registerHelper("neq",(function(e,t){return e!==t})),Handlebars.registerHelper("or",(function(e,t){return e||t})),Handlebars.registerHelper("ternary",(function(e,t,r){return e?t:r})),Handlebars.registerHelper("concat",(function(e,t){return"".concat(e).concat(t)})),Handlebars.registerHelper("strOrSpace",(function(e){return"string"==typeof e?e&&e.length?e:"&nbsp;":e})),Handlebars.registerHelper("trainingIcon",(function(e){switch(e){case 0:return'<span title="'.concat(game.i18n.localize("CSR.training.inability"),'">[I]</span>');case 1:return'<span title="'.concat(game.i18n.localize("CSR.training.untrained"),'">[U]</span>');case 2:return'<span title="'.concat(game.i18n.localize("CSR.training.trained"),'">[T]</span>');case 3:return'<span title="'.concat(game.i18n.localize("CSR.training.specialized"),'">[S]</span>')}return""})),Handlebars.registerHelper("poolIcon",(function(e){switch(e){case 0:return'<span title="'.concat(game.i18n.localize("CSR.pool.might"),'">[M]</span>');case 1:return'<span title="'.concat(game.i18n.localize("CSR.pool.speed"),'">[S]</span>');case 2:return'<span title="'.concat(game.i18n.localize("CSR.pool.intellect"),'">[I]</span>')}return""})),Handlebars.registerHelper("typeIcon",(function(e){switch(e){case"armor":return'<span title="'.concat(game.i18n.localize("CSR.inventory.armor"),'">[a]</span>');case"weapon":return'<span title="'.concat(game.i18n.localize("CSR.inventory.weapon"),'">[w]</span>');case"gear":return'<span title="'.concat(game.i18n.localize("CSR.inventory.gear"),'">[g]</span>');case"cypher":return'<span title="'.concat(game.i18n.localize("CSR.inventory.cypher"),'">[C]</span>');case"artifact":return'<span title="'.concat(game.i18n.localize("CSR.inventory.armor"),'">[A]</span>');case"oddity":return'<span title="'.concat(game.i18n.localize("CSR.inventory.armor"),'">[O]</span>')}return""}))}},{}],17:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.CypherSystemItemSheet=void 0;var n=a(e("@babel/runtime/helpers/classCallCheck")),i=a(e("@babel/runtime/helpers/createClass")),o=a(e("@babel/runtime/helpers/get")),l=a(e("@babel/runtime/helpers/inherits")),s=a(e("@babel/runtime/helpers/possibleConstructorReturn")),c=a(e("@babel/runtime/helpers/getPrototypeOf")),u=e("../config.js");function f(e){var t=(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}})();return function(){var r,a=(0,c.default)(e);if(t){var n=(0,c.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,s.default)(this,r)}}var p=(function(e){(0,l.default)(r,e);var t=f(r);function r(){return(0,n.default)(this,r),t.apply(this,arguments)}return(0,i.default)(r,[{key:"_skillData",value:function(e){e.stats=u.CSR.stats,e.trainingLevels=u.CSR.trainingLevels}},{key:"_abilityData",value:function(e){e.ranges=u.CSR.optionalRanges,e.stats=u.CSR.stats}},{key:"_armorData",value:function(e){e.weightClasses=u.CSR.weightClasses}},{key:"_weaponData",value:function(e){e.ranges=u.CSR.ranges,e.weaponTypes=u.CSR.weaponTypes,e.weightClasses=u.CSR.weightClasses}},{key:"_gearData",value:function(e){}},{key:"_cypherData",value:function(e){e.isGM=game.user.isGM}},{key:"_artifactData",value:function(e){e.isGM=game.user.isGM}},{key:"_oddityData",value:function(e){e.isGM=game.user.isGM}},{key:"getData",value:function(){var e=(0,o.default)((0,c.default)(r.prototype),"getData",this).call(this);switch(this.item.data.type){case"skill":this._skillData(e);break;case"ability":this._abilityData(e);break;case"armor":this._armorData(e);break;case"weapon":this._weaponData(e);break;case"gear":this._gearData(e);break;case"cypher":this._cypherData(e);break;case"artifact":this._artifactData(e);break;case"oddity":this._oddityData(e)}return e}},{key:"setPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,o.default)((0,c.default)(r.prototype),"setPosition",this).call(this,e),a=this.element.find(".sheet-body"),n=t.height-192;return a.css("height",n),t}},{key:"_skillListeners",value:function(e){e.closest(".window-app.sheet.item").addClass("skill-window"),this.options.editable&&(e.find('select[name="data.pool"]').select2({theme:"numenera",width:"110px",minimumResultsForSearch:1/0}),e.find('select[name="data.training"]').select2({theme:"numenera",width:"110px",minimumResultsForSearch:1/0}))}},{key:"_abilityListeners",value:function(e){var t=this;(e.closest(".window-app.sheet.item").addClass("ability-window"),this.options.editable)&&(e.find('select[name="data.isEnabler"]').select2({theme:"numenera",width:"220px",minimumResultsForSearch:1/0}),e.find('select[name="data.cost.pool"]').select2({theme:"numenera",width:"85px",minimumResultsForSearch:1/0}),e.find('select[name="data.range"]').select2({theme:"numenera",width:"120px",minimumResultsForSearch:1/0}),e.find("#cb-identified").on("change",(function(e){e.preventDefault(),e.stopPropagation(),t.item.update({"data.identified":e.target.checked})})))}},{key:"_armorListeners",value:function(e){e.closest(".window-app.sheet.item").addClass("armor-window"),this.options.editable&&e.find('select[name="data.weight"]').select2({theme:"numenera",width:"100px",minimumResultsForSearch:1/0})}},{key:"_weaponListeners",value:function(e){e.closest(".window-app.sheet.item").addClass("weapon-window"),this.options.editable&&(e.find('select[name="data.weight"]').select2({theme:"numenera",width:"110px",minimumResultsForSearch:1/0}),e.find('select[name="data.category"]').select2({theme:"numenera",width:"110px",minimumResultsForSearch:1/0}),e.find('select[name="data.range"]').select2({theme:"numenera",width:"120px",minimumResultsForSearch:1/0}))}},{key:"_gearListeners",value:function(e){e.closest(".window-app.sheet.item").addClass("gear-window")}},{key:"_cypherListeners",value:function(e){e.closest(".window-app.sheet.item").addClass("cypher-window")}},{key:"_artifactListeners",value:function(e){e.closest(".window-app.sheet.item").addClass("artifact-window")}},{key:"_oddityListeners",value:function(e){e.closest(".window-app.sheet.item").addClass("oddity-window")}},{key:"activateListeners",value:function(e){switch((0,o.default)((0,c.default)(r.prototype),"activateListeners",this).call(this,e),this.item.data.type){case"skill":this._skillListeners(e);break;case"ability":this._abilityListeners(e);break;case"armor":this._armorListeners(e);break;case"weapon":this._weaponListeners(e);break;case"gear":this._gearListeners(e);break;case"cypher":this._cypherListeners(e);break;case"artifact":this._artifactListeners(e);break;case"oddity":this._oddityListeners(e)}}},{key:"template",get:function(){return"".concat("systems/cyphersystem/templates/item","/").concat(this.item.data.type,"-sheet.html")}}],[{key:"defaultOptions",get:function(){return mergeObject((0,o.default)((0,c.default)(r),"defaultOptions",this),{classes:["cyphersystem","sheet","item"],width:300,height:200})}}]),r})(ItemSheet);r.CypherSystemItemSheet=p},{"../config.js":5,"@babel/runtime/helpers/classCallCheck":31,"@babel/runtime/helpers/createClass":32,"@babel/runtime/helpers/get":33,"@babel/runtime/helpers/getPrototypeOf":34,"@babel/runtime/helpers/inherits":35,"@babel/runtime/helpers/interopRequireDefault":36,"@babel/runtime/helpers/possibleConstructorReturn":39}],18:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.CypherSystemItem=void 0;var n=a(e("@babel/runtime/regenerator")),i=a(e("@babel/runtime/helpers/asyncToGenerator")),o=a(e("@babel/runtime/helpers/classCallCheck")),l=a(e("@babel/runtime/helpers/createClass")),s=a(e("@babel/runtime/helpers/get")),c=a(e("@babel/runtime/helpers/inherits")),u=a(e("@babel/runtime/helpers/possibleConstructorReturn")),f=a(e("@babel/runtime/helpers/getPrototypeOf")),p=e("../rolls.js"),d=e("../utils.js"),m=a(e("../enums/enum-pool.js")),h=a(e("../enums/enum-training.js")),y=a(e("../enums/enum-weight.js")),v=a(e("../enums/enum-range.js")),b=a(e("../enums/enum-weapon-category.js"));function g(e){var t=(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}})();return function(){var r,a=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return(0,u.default)(this,r)}}var k=(function(e){(0,c.default)(r,e);var t=g(r);function r(){return(0,o.default)(this,r),t.apply(this,arguments)}return(0,l.default)(r,[{key:"_prepareSkillData",value:function(){var e=this.data,t=e.data;t.name=(0,d.valOrDefault)(e.name,game.i18n.localize("CSR.new.skill")),t.pool=(0,d.valOrDefault)(t.pool,0),t.training=(0,d.valOrDefault)(t.training,1),t.notes=(0,d.valOrDefault)(t.notes,""),t.flags=(0,d.valOrDefault)(t.flags,{})}},{key:"_prepareAbilityData",value:function(){var e=this.data,t=e.data;t.name=(0,d.valOrDefault)(e.name,game.i18n.localize("CSR.new.ability")),t.sourceType=(0,d.valOrDefault)(t.sourceType,""),t.sourceValue=(0,d.valOrDefault)(t.sourceValue,""),t.isEnabler=(0,d.valOrDefault)(t.isEnabler,!0),t.cost=(0,d.valOrDefault)(t.cost,{value:0,pool:0}),t.range=(0,d.valOrDefault)(t.range,0),t.notes=(0,d.valOrDefault)(t.notes,"")}},{key:"_prepareArmorData",value:function(){var e=this.data,t=e.data;t.name=(0,d.valOrDefault)(e.name,game.i18n.localize("CSR.new.armor")),t.armor=(0,d.valOrDefault)(t.armor,1),t.additionalSpeedEffortCost=(0,d.valOrDefault)(t.additionalSpeedEffortCost,1),t.price=(0,d.valOrDefault)(t.price,0),t.weight=(0,d.valOrDefault)(t.weight,0),t.quantity=(0,d.valOrDefault)(t.quantity,1),t.equipped=(0,d.valOrDefault)(t.equipped,!1),t.notes=(0,d.valOrDefault)(t.notes,"")}},{key:"_prepareWeaponData",value:function(){var e=this.data,t=e.data;t.name=(0,d.valOrDefault)(e.name,game.i18n.localize("CSR.new.weapon")),t.damage=(0,d.valOrDefault)(t.damage,1),t.category=(0,d.valOrDefault)(t.category,0),t.range=(0,d.valOrDefault)(t.range,0),t.price=(0,d.valOrDefault)(t.price,0),t.weight=(0,d.valOrDefault)(t.weight,0),t.quantity=(0,d.valOrDefault)(t.quantity,1),t.equipped=(0,d.valOrDefault)(t.equipped,!1),t.notes=(0,d.valOrDefault)(t.notes,"")}},{key:"_prepareGearData",value:function(){var e=this.data,t=e.data;t.name=(0,d.valOrDefault)(e.name,game.i18n.localize("CSR.new.gear")),t.price=(0,d.valOrDefault)(t.price,0),t.quantity=(0,d.valOrDefault)(t.quantity,1),t.notes=(0,d.valOrDefault)(t.notes,"")}},{key:"_prepareCypherData",value:function(){var e=this.data,t=e.data;t.name=(0,d.valOrDefault)(e.name,game.i18n.localize("CSR.new.cypher")),t.identified=(0,d.valOrDefault)(t.identified,!1),t.level=(0,d.valOrDefault)(t.level,null),t.levelDie=(0,d.valOrDefault)(t.levelDie,""),t.form=(0,d.valOrDefault)(t.form,""),t.effect=(0,d.valOrDefault)(t.effect,""),t.notes=(0,d.valOrDefault)(t.notes,"")}},{key:"_prepareArtifactData",value:function(){var e=this.data,t=e.data;t.name=(0,d.valOrDefault)(e.name,game.i18n.localize("CSR.new.artifact")),t.identified=(0,d.valOrDefault)(t.identified,!1),t.level=(0,d.valOrDefault)(t.level,null),t.levelDie=(0,d.valOrDefault)(t.levelDie,""),t.form=(0,d.valOrDefault)(t.form,""),t.effect=(0,d.valOrDefault)(t.effect,""),t.depletion=(0,d.valOrDefault)(t.depletion,{isDepleting:!0,die:"d6",threshold:1}),t.notes=(0,d.valOrDefault)(t.notes,"")}},{key:"_prepareOddityData",value:function(){var e=this.data,t=e.data;t.name=(0,d.valOrDefault)(e.name,game.i18n.localize("CSR.new.oddity")),t.notes=(0,d.valOrDefault)(t.notes,"")}},{key:"prepareData",value:function(){switch((0,s.default)((0,f.default)(r.prototype),"prepareData",this).call(this),this.type){case"skill":this._prepareSkillData();break;case"ability":this._prepareAbilityData();break;case"armor":this._prepareArmorData();break;case"weapon":this._prepareWeaponData();break;case"gear":this._prepareGearData();break;case"cypher":this._prepareCypherData();break;case"artifact":this._prepareArtifactData();break;case"oddity":this._prepareOddityData()}}},{key:"_skillRoll",value:function(){var e=this.actor,t=e.data.data,r=this.name,a=this.data.data.pool,n=e.getSkillLevel(this),i=e.getFreeEffortFromStat(a),o=["1d20"];if(0!==n){var l=n<0?"-":"+";o.push("".concat(l," ").concat(3*Math.abs(n)))}(0,p.cypherRoll)({parts:o,data:{pool:a,poolCost:0,effort:i,maxEffort:t.effort,assets:n},event:event,title:game.i18n.localize("CSR.roll.skill.title"),flavor:game.i18n.localize("CSR.roll.skill.flavor").replace("##ACTOR##",e.name).replace("##SKILL##",r),actor:e,speaker:ChatMessage.getSpeaker({actor:e})})}},{key:"_abilityRoll",value:function(){var e=this.actor,t=e.data.data,r=this.name,a=this.data.data,n=a.isEnabler,i=a.cost;if(n)ChatMessage.create([{speaker:ChatMessage.getSpeaker({actor:e}),flavor:game.i18n.localize("CSR.roll.ability.invalid.flavor"),content:game.i18n.localize("CSR.roll.ability.invalid.content")}]);else{var o=i.pool,l=i.value,s=e.getEdgeFromStat(o),c=Math.max(l-s,0),u=e.getFreeEffortFromStat(o);if(e.canSpendFromPool(o,parseInt(l,10)))(0,p.cypherRoll)({event:event,parts:["1d20"],data:{pool:o,poolCost:c,effort:u,maxEffort:t.effort},speaker:ChatMessage.getSpeaker({actor:e}),flavor:"".concat(e.name," used ").concat(r),title:game.i18n.localize("CSR.roll.ability.title"),actor:e});else{var f=m.default[o];ChatMessage.create([{speaker:ChatMessage.getSpeaker({actor:e}),flavor:game.i18n.localize("CSR.roll.ability.failed.flavor"),content:game.i18n.localize("CSR.roll.ability.failed.content").replace("##POOL##",f)}])}}}},{key:"roll",value:function(){switch(this.type){case"skill":this._skillRoll();break;case"ability":this._abilityRoll()}}},{key:"_skillInfo",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t,r,a,i,o,l;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.data,r=t.data,a=h.default[t.data.training],i=m.default[t.data.pool],o={name:t.name,training:a.toLowerCase(),pool:i.toLowerCase(),notes:r.notes,initiative:!!r.flags.initiative},e.next=7,renderTemplate("systems/cyphersystem/templates/actor/partials/info/skill-info.html",o);case 7:return l=e.sent,e.abrupt("return",l);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()},{key:"_abilityInfo",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t,r,a,i,o;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.data,r=t.data,a=m.default[r.cost.pool],i={name:t.name,pool:a.toLowerCase(),isEnabler:r.isEnabler,cost:r.cost.value,notes:r.notes},e.next=6,renderTemplate("systems/cyphersystem/templates/actor/partials/info/ability-info.html",i);case 6:return o=e.sent,e.abrupt("return",o);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()},{key:"_armorInfo",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t,r,a,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.data,r=y.default[t.data.weight],a={name:this.name,type:this.type,equipped:t.data.equipped,quantity:t.data.quantity,weight:r.toLowerCase(),armor:t.data.armor,additionalSpeedEffortCost:t.data.additionalSpeedEffortCost,price:t.data.price,notes:t.data.notes},e.next=5,renderTemplate("systems/cyphersystem/templates/actor/partials/info/armor-info.html",a);case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()},{key:"_weaponInfo",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t,r,a,i,o,l;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.data,r=y.default[t.data.weight],a=v.default[t.data.range],i=b.default[t.data.category],o={name:this.name,type:this.type,equipped:t.data.equipped,quantity:t.data.quantity,weight:r.toLowerCase(),range:a.toLowerCase(),category:i.toLowerCase(),damage:t.data.damage,price:t.data.price,notes:t.data.notes},e.next=7,renderTemplate("systems/cyphersystem/templates/actor/partials/info/weapon-info.html",o);case 7:return l=e.sent,e.abrupt("return",l);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()},{key:"_gearInfo",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t,r,a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.data,r={name:t.name,type:this.type,quantity:t.data.quantity,price:t.data.price,notes:t.data.notes},e.next=4,renderTemplate("systems/cyphersystem/templates/actor/partials/info/gear-info.html",r);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()},{key:"_cypherInfo",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t,r,a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.data,r={name:t.name,type:this.type,isGM:game.user.isGM,identified:t.data.identified,level:t.data.level,form:t.data.form,effect:t.data.effect},e.next=4,renderTemplate("systems/cyphersystem/templates/actor/partials/info/cypher-info.html",r);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()},{key:"_artifactInfo",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t,r,a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.data,r={name:t.name,type:this.type,isGM:game.user.isGM,identified:t.data.identified,level:t.data.level,form:t.data.form,isDepleting:t.data.depletion.isDepleting,depletionThreshold:t.data.depletion.threshold,depletionDie:t.data.depletion.die,effect:t.data.effect},e.next=4,renderTemplate("systems/cyphersystem/templates/actor/partials/info/artifact-info.html",r);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()},{key:"_oddityInfo",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t,r,a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.data,r={name:t.name,type:this.type,notes:t.data.notes},e.next=4,renderTemplate("systems/cyphersystem/templates/actor/partials/info/oddity-info.html",r);case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()},{key:"getInfo",value:(function(){var e=(0,i.default)(n.default.mark((function e(){var t;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t="",e.t0=this.type,e.next="skill"===e.t0?4:"ability"===e.t0?8:"armor"===e.t0?12:"weapon"===e.t0?16:"gear"===e.t0?20:"cypher"===e.t0?24:"artifact"===e.t0?28:"oddity"===e.t0?32:36;break;case 4:return e.next=6,this._skillInfo();case 6:return t=e.sent,e.abrupt("break",36);case 8:return e.next=10,this._abilityInfo();case 10:return t=e.sent,e.abrupt("break",36);case 12:return e.next=14,this._armorInfo();case 14:return t=e.sent,e.abrupt("break",36);case 16:return e.next=18,this._weaponInfo();case 18:return t=e.sent,e.abrupt("break",36);case 20:return e.next=22,this._gearInfo();case 22:return t=e.sent,e.abrupt("break",36);case 24:return e.next=26,this._cypherInfo();case 26:return t=e.sent,e.abrupt("break",36);case 28:return e.next=30,this._artifactInfo();case 30:return t=e.sent,e.abrupt("break",36);case 32:return e.next=34,this._oddityInfo();case 34:return t=e.sent,e.abrupt("break",36);case 36:return e.abrupt("return",t);case 37:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}})()}]),r})(Item);r.CypherSystemItem=k},{"../enums/enum-pool.js":11,"../enums/enum-range.js":12,"../enums/enum-training.js":13,"../enums/enum-weapon-category.js":14,"../enums/enum-weight.js":15,"../rolls.js":22,"../utils.js":26,"@babel/runtime/helpers/asyncToGenerator":30,"@babel/runtime/helpers/classCallCheck":31,"@babel/runtime/helpers/createClass":32,"@babel/runtime/helpers/get":33,"@babel/runtime/helpers/getPrototypeOf":34,"@babel/runtime/helpers/inherits":35,"@babel/runtime/helpers/interopRequireDefault":36,"@babel/runtime/helpers/possibleConstructorReturn":39,"@babel/runtime/regenerator":45}],19:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.usePoolMacro=function(e,t){var r=game.actors.entities.find((function(t){return t._id===e})),a=r.data.data,n=l.default[t],i=r.getFreeEffortFromStat(t);(0,o.cypherRoll)({parts:["1d20"],data:{pool:t,effort:i,maxEffort:a.effort},event:event,title:game.i18n.localize("CSR.roll.pool.title").replace("##POOL##",n),flavor:game.i18n.localize("CSR.roll.pool.flavor").replace("##ACTOR##",r.name).replace("##POOL##",n),actor:r,speaker:ChatMessage.getSpeaker({actor:r})})},r.useSkillMacro=function(e,t){game.actors.entities.find((function(t){return t._id===e})).getOwnedItem(t).roll()},r.useAbilityMacro=function(e,t){game.actors.entities.find((function(t){return t._id===e})).getOwnedItem(t).roll()},r.useCypherMacro=function(e,t){console.warn("Cypher macros not implemented")},r.createCypherMacro=function(e,t){return m.apply(this,arguments)};var n=a(e("@babel/runtime/regenerator")),i=a(e("@babel/runtime/helpers/asyncToGenerator")),o=e("./rolls.js"),l=a(e("./enums/enum-pool.js"));var s=["pool","skill","ability"];function c(e){return!!s.includes(e.type)&&("ability"!==e.type||!e.data.isEnabler)}function u(e){return"ability"===e.type&&e.data.isEnabler?game.i18n.localize("CSR.macro.create.abilityEnabler"):game.i18n.localize("CSR.macro.create.unsupportedType")}function f(e){var t=e.data;if("pool"===t.type)return"game.cyphersystem.macro.usePool('".concat(e.actorId,"', ").concat(t.pool,");");var r=t.type.substr(0,1).toUpperCase()+t.type.substr(1);return"game.cyphersystem.macro.use".concat(r,"('").concat(e.actorId,"', '").concat(t._id,"');")}function p(e,t){return d.apply(this,arguments)}function d(){return(d=(0,i.default)(n.default.mark((function e(t,r){var a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"pool"===t.type?(a=l.default[t.pool],t.name=game.i18n.localize("CSR.macro.pool.name").replace("##POOL##",a),t.img="icons/svg/d20.svg"):"skill"===t.type?t.img="icons/svg/mystery-man.svg"===t.img?"icons/svg/aura.svg":t.img:"ability"===t.type&&(t.img="icons/svg/mystery-man.svg"===t.img?"icons/svg/book.svg":t.img),e.next=3,Macro.create({name:t.name,type:"script",img:t.img,command:r,flags:{"cyphersystem.itemMacro":!0}});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){return(m=(0,i.default)(n.default.mark((function e(t,r){var a,i,o;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("data"in t){e.next=3;break}return e.abrupt("return",ui.notifications.warn(game.i18n.localize("CSR.macro.create.notOwned")));case 3:if(c(a=t.data)){e.next=6;break}return e.abrupt("return",ui.notifications.warn(u(a)));case 6:if(i=f(t),o=game.macros.entities.find((function(e){return e.name===a.name&&e.command===i}))){e.next=12;break}return e.next=11,p(a,i);case 11:o=e.sent;case 12:return game.user.assignHotbarMacro(o,r),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},{"./enums/enum-pool.js":11,"./rolls.js":22,"@babel/runtime/helpers/asyncToGenerator":30,"@babel/runtime/helpers/interopRequireDefault":36,"@babel/runtime/regenerator":45}],20:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=function(){return l.apply(this,arguments)};var n=a(e("@babel/runtime/regenerator")),i=a(e("@babel/runtime/helpers/asyncToGenerator")),o=e("./npc-migrations");function l(){return(l=(0,i.default)(n.default.mark((function e(){var t,r,a,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(game.user.isGM){e.next=2;break}return e.abrupt("return");case 2:console.info("--- Starting Migration Process ---"),t=game.actors.entities.filter((function(e){return"npc"===e.data.type})),r=0;case 5:if(!(r<t.length)){e.next=15;break}return a=t[r],e.next=9,(0,o.NPCMigrator)(a);case 9:return i=e.sent,e.next=12,a.update(i);case 12:r++,e.next=5;break;case 15:console.info("--- Migration Process Finished ---");case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},{"./npc-migrations":21,"@babel/runtime/helpers/asyncToGenerator":30,"@babel/runtime/helpers/interopRequireDefault":36,"@babel/runtime/regenerator":45}],21:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.NPCMigrator=void 0;var n=a(e("@babel/runtime/regenerator")),i=a(e("@babel/runtime/helpers/asyncToGenerator")),o=[{version:2,action:function(e,t){return t["data.health"]=e.data.data.health.max,t}}];function l(){return(l=(0,i.default)(n.default.mark((function e(t){var r,a,i=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},a=Object.assign({_id:t._id,data:{version:t.data.data.version}},r),o.forEach((function(e){a.data.version<e.version&&((a=e.action(t,a)).version=e.version)})),e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var s=function(e){return l.apply(this,arguments)};r.NPCMigrator=s},{"@babel/runtime/helpers/asyncToGenerator":30,"@babel/runtime/helpers/interopRequireDefault":36,"@babel/runtime/regenerator":45}],22:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.rollText=function(e,t){var r=[],a=Math.floor(t/3),n=Math.floor((t-e)/3+.5),i=a+n,o="#000000";o=i<3?"#0a860a":i<7?"#848409":"#0a860a";var l="<".concat(i,">");if(0!==n){var s=n>0?"+":"";l+=" (".concat(a).concat(s).concat(n,")")}switch(r.push({text:l,color:o,cls:"target-number"}),e){case 1:r.push({text:game.i18n.localize("CSR.chat.intrusion"),color:"#000000",cls:"effect"});break;case 19:r.push({text:game.i18n.localize("CSR.chat.effect.minor"),color:"#000000",cls:"effect"});break;case 20:r.push({text:game.i18n.localize("CSR.chat.effect.major"),color:"#000000",cls:"effect"})}return r},r.cypherRoll=function(){return s.apply(this,arguments)};var n=a(e("@babel/runtime/regenerator")),i=a(e("@babel/runtime/helpers/asyncToGenerator")),o=e("./dialog/roll-dialog.js"),l=a(e("./enums/enum-pool.js"));function s(){return(s=(0,i.default)(n.default.mark((function e(){var t,r,a,i,s,c,u,f,p,d,m,h,y,v,b,g,k,w,C,S,D,R,_,O,x,I=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=I.length>0&&void 0!==I[0]?I[0]:{},r=t.parts,a=void 0===r?[]:r,i=t.data,s=void 0===i?{}:i,c=t.actor,u=void 0===c?null:c,f=t.event,void 0===f?null:f,p=t.speaker,d=void 0===p?null:p,m=t.flavor,h=void 0===m?null:m,y=t.title,v=void 0===y?null:y,b=t.item,void 0!==b&&b,g=game.settings.get("core","rollMode"),k=!1,w=a.filter((function(e){return""!=e&&e})),C=0,S=0,s.effort&&(C=parseInt(s.effort,10)||0,S=C),D=1,s.maxEffort&&(D=parseInt(s.maxEffort,10)||1),R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&(s.effort=parseInt(e.effort.value,10)),s.effort&&(w.push("+".concat(3*s.effort)),h+=game.i18n.localize("CSR.roll.effort.flavor").replace("##EFFORT##",s.effort));var t=new Roll(w.join(""),s).roll();return g=e?e.rollMode.value:g,k=!0,t},"systems/cyphersystem/templates/dialog/roll-dialog.html",_={formula:w.join(" "),effort:C,minEffort:S,maxEffort:D,data:s,rollMode:g,rollModes:CONFIG.Dice.rollModes},e.next=14,renderTemplate("systems/cyphersystem/templates/dialog/roll-dialog.html",_);case 14:return O=e.sent,e.abrupt("return",new Promise(function(e){new o.RollDialog({title:v,content:O,buttons:{ok:{label:"OK",icon:'<i class="fas fa-check"></i>',callback:function(e){x=R(e.find("form")[0]);var t=s.pool,r=parseInt(s.effort||0,10),a=u.getEffortCostFromStat(t,r),n=parseInt(s.poolCost||0,10)+parseInt(a.cost,10);if(u.canSpendFromPool(t,n)&&!a.warning)x.toMessage({speaker:d,flavor:h},{rollMode:g}),u.spendFromPool(t,Math.max(n,0));else{var i=l.default[t];ChatMessage.create([{speaker:d,flavor:game.i18n.localize("CSR.roll.failed.flavor"),content:game.i18n.localize("CSR.roll.failed.content").replace("##POOL##",i)}])}}},cancel:{icon:'<i class="fas fa-times"></i>',label:"Cancel"}},default:"ok",close:function(){e(!!k&&x)}}).render(!0)}));case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},{"./dialog/roll-dialog.js":10,"./enums/enum-pool.js":11,"@babel/runtime/helpers/asyncToGenerator":30,"@babel/runtime/helpers/interopRequireDefault":36,"@babel/runtime/regenerator":45}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.registerSystemSettings=void 0;r.registerSystemSettings=function(){game.settings.register("cyphersystem","currencyName",{name:"SETTINGS.name.currencyName",hint:"SETTINGS.hint.currencyName",scope:"world",config:!0,type:String,default:"Money"})}},{}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.csrSocketListeners=function(){game.socket.on("system.cyphersystem",n)};var a=e("./dialog/gm-intrusion-dialog.js");function n(e){switch(e.type){case"gmIntrusion":!(function(e){var t=e.data,r=t.actorId,n=t.userIds;if(!game.ready||game.user.isGM||!n.find((function(e){return e===game.userId})))return;var i=game.actors.entities.find((function(e){return e.data._id===r}));new a.GMIntrusionDialog(i).render(!0)})(e);break;case"awardXP":!(function(e){var t=e.data,r=t.actorId,a=t.xpAmount;if(!game.ready||!game.user.isGM)return;var n=game.actors.get(r);n.update({"data.xp":n.data.data.xp+a}),ChatMessage.create({content:game.i18n.localize("CSR.intrusion.awardXP").replace("##ACTOR##",n.data.name)})})(e)}}},{"./dialog/gm-intrusion-dialog.js":8}],25:[function(e,t,r){"use strict";var a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.preloadHandlebarsTemplates=void 0;var n=a(e("@babel/runtime/regenerator")),i=a(e("@babel/runtime/helpers/asyncToGenerator")),o=(function(){var e=(0,i.default)(n.default.mark((function e(){var t;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["systems/cyphersystem/templates/actor/pc-sheet.html","systems/cyphersystem/templates/actor/npc-sheet.html","systems/cyphersystem/templates/actor/partials/pools.html","systems/cyphersystem/templates/actor/partials/advancement.html","systems/cyphersystem/templates/actor/partials/damage-track.html","systems/cyphersystem/templates/actor/partials/recovery.html","systems/cyphersystem/templates/actor/partials/skills.html","systems/cyphersystem/templates/actor/partials/abilities.html","systems/cyphersystem/templates/actor/partials/inventory.html","systems/cyphersystem/templates/actor/partials/info/skill-info.html","systems/cyphersystem/templates/actor/partials/info/ability-info.html","systems/cyphersystem/templates/actor/partials/info/armor-info.html","systems/cyphersystem/templates/actor/partials/info/weapon-info.html","systems/cyphersystem/templates/actor/partials/info/gear-info.html","systems/cyphersystem/templates/actor/partials/info/cypher-info.html","systems/cyphersystem/templates/actor/partials/info/artifact-info.html","systems/cyphersystem/templates/actor/partials/info/oddity-info.html","systems/cyphersystem/templates/item/skill-sheet.html","systems/cyphersystem/templates/item/armor-sheet.html","systems/cyphersystem/templates/item/weapon-sheet.html","systems/cyphersystem/templates/item/gear-sheet.html","systems/cyphersystem/templates/item/cypher-sheet.html","systems/cyphersystem/templates/item/artifact-sheet.html","systems/cyphersystem/templates/item/oddity-sheet.html","systems/cyphersystem/templates/dialog/roll-dialog.html"],e.abrupt("return",loadTemplates(t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})();r.preloadHandlebarsTemplates=o},{"@babel/runtime/helpers/asyncToGenerator":30,"@babel/runtime/helpers/interopRequireDefault":36,"@babel/runtime/regenerator":45}],26:[function(e,t,r){"use strict";function a(e){return!(null==e)}Object.defineProperty(r,"__esModule",{value:!0}),r.deepProp=function(e,t){var r=t.split("."),a=e;return r.forEach((function(e){e in a&&(a=a[e])})),a},r.isDefined=a,r.valOrDefault=function(e,t){return a(e)?e:t}},{}],27:[function(e,t,r){t.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}},{}],28:[function(e,t,r){t.exports=function(e){if(Array.isArray(e))return e}},{}],29:[function(e,t,r){t.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},{}],30:[function(e,t,r){function a(e,t,r,a,n,i,o){try{var l=e[i](o),s=l.value}catch(e){return void r(e)}l.done?t(s):Promise.resolve(s).then(a,n)}t.exports=function(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function l(e){a(o,n,i,l,s,"next",e)}function s(e){a(o,n,i,l,s,"throw",e)}l(void 0)})}}},{}],31:[function(e,t,r){t.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},{}],32:[function(e,t,r){function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}t.exports=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}},{}],33:[function(e,t,r){var a=e("./superPropBase");function n(e,r,i){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=n=Reflect.get:t.exports=n=function(e,t,r){var n=a(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}},n(e,r,i||e)}t.exports=n},{"./superPropBase":42}],34:[function(e,t,r){function a(e){return t.exports=a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}t.exports=a},{}],35:[function(e,t,r){var a=e("./setPrototypeOf");t.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}},{"./setPrototypeOf":40}],36:[function(e,t,r){t.exports=function(e){return e&&e.__esModule?e:{default:e}}},{}],37:[function(e,t,r){t.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],a=!0,n=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);a=!0);}catch(e){n=!0,i=e}finally{try{a||null==l.return||l.return()}finally{if(n)throw i}}return r}}},{}],38:[function(e,t,r){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},{}],39:[function(e,t,r){var a=e("@babel/runtime/helpers/typeof"),n=e("./assertThisInitialized");t.exports=function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?n(e):t}},{"./assertThisInitialized":29,"@babel/runtime/helpers/typeof":43}],40:[function(e,t,r){function a(e,r){return t.exports=a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,r)}t.exports=a},{}],41:[function(e,t,r){var a=e("./arrayWithHoles"),n=e("./iterableToArrayLimit"),i=e("./unsupportedIterableToArray"),o=e("./nonIterableRest");t.exports=function(e,t){return a(e)||n(e,t)||i(e,t)||o()}},{"./arrayWithHoles":28,"./iterableToArrayLimit":37,"./nonIterableRest":38,"./unsupportedIterableToArray":44}],42:[function(e,t,r){var a=e("./getPrototypeOf");t.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=a(e)););return e}},{"./getPrototypeOf":34}],43:[function(e,t,r){function a(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=a=function(e){return typeof e}:t.exports=a=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}t.exports=a},{}],44:[function(e,t,r){var a=e("./arrayLikeToArray");t.exports=function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}},{"./arrayLikeToArray":27}],45:[function(e,t,r){t.exports=e("regenerator-runtime")},{"regenerator-runtime":46}],46:[function(e,t,r){var a=(function(e){"use strict";var t,r=Object.prototype,a=r.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",l=n.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function c(e,t,r,a){var n=t&&t.prototype instanceof y?t:y,i=Object.create(n.prototype),o=new x(a||[]);return i._invoke=(function(e,t,r){var a=f;return function(n,i){if(a===d)throw new Error("Generator is already running");if(a===m){if("throw"===n)throw i;return j()}for(r.method=n,r.arg=i;;){var o=r.delegate;if(o){var l=R(o,r);if(l){if(l===h)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===f)throw a=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=d;var s=u(e,t,r);if("normal"===s.type){if(a=r.done?m:p,s.arg===h)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=m,r.method="throw",r.arg=s.arg)}}})(e,r,o),i}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f="suspendedStart",p="suspendedYield",d="executing",m="completed",h={};function y(){}function v(){}function b(){}var g={};g[i]=function(){return this};var k=Object.getPrototypeOf,w=k&&k(k(I([])));w&&w!==r&&a.call(w,i)&&(g=w);var C=b.prototype=y.prototype=Object.create(g);function S(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function D(e,t){var r;this._invoke=function(n,i){function o(){return new t(function(r,o){!(function r(n,i,o,l){var s=u(e[n],e,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==typeof f&&a.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,o,l)}),(function(e){r("throw",e,o,l)})):t.resolve(f).then((function(e){c.value=e,o(c)}),(function(e){return r("throw",e,o,l)}))}l(s.arg)})(n,i,r,o)})}return r=r?r.then(o,o):o()}}function R(e,r){var a=e.iterator[r.method];if(a===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,R(e,r),"throw"===r.method))return h;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var n=u(a,e.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,h;var i=n.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function I(e){if(e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function r(){for(;++n<e.length;)if(a.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:j}}function j(){return{value:t,done:!0}}return v.prototype=C.constructor=b,b.constructor=v,v.displayName=s(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,l,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},S(D.prototype),D.prototype[o]=function(){return this},e.AsyncIterator=D,e.async=function(t,r,a,n,i){void 0===i&&(i=Promise);var o=new D(c(t,r,a,n),i);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},S(C),s(C,l,"Generator"),C[i]=function(){return this},C.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var a=t.pop();if(a in e)return r.value=a,r.done=!1,r}return r.done=!0,r}},e.values=I,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(a,n){return l.type="throw",l.arg=e,r.next=a,n&&(r.method="next",r.arg=t),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],l=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=a.call(o,"catchLoc"),c=a.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var a=r.completion;if("throw"===a.type){var n=a.arg;O(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,a){return this.delegate={iterator:I(e),resultName:r,nextLoc:a},"next"===this.method&&(this.arg=t),h}},e})("object"==typeof t?t.exports:{});try{regeneratorRuntime=a}catch(e){Function("r","regeneratorRuntime = r")(a)}},{}]},{},[7]);